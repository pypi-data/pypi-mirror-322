export const ids=["48240"];export const modules={50875:function(t,e,i){i.d(e,{Eu:function(){return o},hZ:function(){return r}});var n=i(11259);const s=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return s[t%s.length]}function r(t,e){const i=e.getPropertyValue(`--graph-color-${t+1}`)||o(t);return(0,n.Rq)(i)}},97547:function(t,e,i){i.a(t,(async function(t,n){try{i.d(e,{c:function(){return m},computeStateDisplay:function(){return _}});var s=i(96194),o=i(20382),r=i(54363),a=i(46467),c=i(64214),u=i(33570),d=i(50602),h=i(87974),l=i(73850),f=t([r,d,a,u,c]);[r,d,a,u,c]=f.then?(await f)():f;const _=(t,e,i,n,s,o,r)=>{const a=o?.[e.entity_id];return m(t,i,n,s,a,e.entity_id,e.attributes,void 0!==r?r:e.state)},m=(t,e,i,n,f,_,m,y)=>{if(y===s.lz||y===s.nZ)return t(`state.default.${y}`);const b=(0,l.M)(_),g="counter"===b||"number"===b||"input_number"===b;if((0,d.sJ)(m,"sensor"===b?i:[])||g){if("duration"===m.device_class&&m.unit_of_measurement&&r.a_.includes(m.unit_of_measurement))try{return(0,r.LU)(e,y,m.unit_of_measurement,f?.display_precision)}catch(t){}if("monetary"===m.device_class)try{return(0,d.uf)(y,e,{style:"currency",currency:m.unit_of_measurement,minimumFractionDigits:2,...(0,d.l4)({state:y,attributes:m},f)})}catch(t){}const i=(0,d.uf)(y,e,(0,d.l4)({state:y,attributes:m},f)),n=f?.translation_key&&t(`component.${f.platform}.entity.${b}.${f.translation_key}.unit_of_measurement`)||m.unit_of_measurement;return n?`${i}${(0,h.L)(n,e)}${n}`:i}if("datetime"===b){const t=new Date(y);return(0,c.o0)(t,e,n)}if(["date","input_datetime","time"].includes(b))try{const t=y.split(" ");if(2===t.length)return(0,c.o0)(new Date(t.join("T")),{...e,time_zone:o.c_.local},n);if(1===t.length){if(y.includes("-"))return(0,a.p6)(new Date(`${y}T00:00`),{...e,time_zone:o.c_.local},n);if(y.includes(":")){const t=new Date;return(0,u.mr)(new Date(`${t.toISOString().split("T")[0]}T${y}`),{...e,time_zone:o.c_.local},n)}}return y}catch(t){return y}if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word"].includes(b)||"sensor"===b&&"timestamp"===m.device_class)try{return(0,c.o0)(new Date(y),e,n)}catch(t){return y}return f?.translation_key&&t(`component.${f.platform}.entity.${b}.${f.translation_key}.state.${y}`)||m.device_class&&t(`component.${b}.entity_component.${m.device_class}.state.${y}`)||t(`component.${b}.entity_component._.state.${y}`)||y};n()}catch(t){n(t)}}))},74564:function(t,e,i){i.d(e,{Z:function(){return s}});const n=t=>{const e=parseFloat(t);if(isNaN(e))throw new Error(`${t} is not a number`);return e};function s(t){if(!t)return null;try{if(t.endsWith("%"))return{w:100,h:n(t.substr(0,t.length-1))};const e=t.replace(":","x").split("x");return 0===e.length?null:1===e.length?{w:n(e[0]),h:1}:{w:n(e[0]),h:n(e[1])}}catch(t){}return null}},6280:function(t,e,i){i.a(t,(async function(t,n){try{i.d(e,{Nu:function(){return H},Vk:function(){return l},xS:function(){return _},xj:function(){return $}});i(92745),i(84283),i(92519),i(42179),i(89256),i(24931),i(88463),i(57449),i(19814),i(39527),i(99790),i(67670),i(41360),i(13334),i(36993);var s=i(73850),o=i(97547),r=i(47194),a=t([o]);o=(a.then?(await a)():a)[0];const c=["climate","humidifier","water_heater"],u=["climate","humidifier","input_datetime","thermostat","water_heater","person","device_tracker"],d=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode","action","current_humidity"],h=(t,e)=>!t.states[e]||u.includes((0,s.M)(e)),l=(t,e,i,n,s)=>{const o={type:"history/stream",entity_ids:s,start_time:i.toISOString(),end_time:n.toISOString(),minimal_response:!0,no_attributes:!s.some((e=>h(t,e)))},r=new f(t);return t.connection.subscribeMessage((t=>e(r.processMessage(t))),o)};class f{constructor(t,e){this.hass=void 0,this.hoursToShow=void 0,this.combinedHistory=void 0,this.hass=t,this.hoursToShow=e,this.combinedHistory={}}processMessage(t){if(!this.combinedHistory||!Object.keys(this.combinedHistory).length)return this.combinedHistory=t.states,this.combinedHistory;if(!Object.keys(t.states).length)return this.combinedHistory;const e=this.hoursToShow?((new Date).getTime()-3600*this.hoursToShow*1e3)/1e3:void 0,i={};for(const t of Object.keys(this.combinedHistory))i[t]=[];for(const e of Object.keys(t.states))i[e]=[];for(const n of Object.keys(i)){if(n in this.combinedHistory&&n in t.states){const e=this.combinedHistory[n],s=e[e.length-1];i[n]=e.concat(t.states[n]),t.states[n][0].lu<s.lu&&(i[n]=i[n].sort(((t,e)=>t.lu-e.lu)))}else n in this.combinedHistory?i[n]=this.combinedHistory[n]:i[n]=t.states[n];if(e&&n in this.combinedHistory){const t=i[n].filter((t=>t.lu<e));if(!t.length)continue;if(i[n]=i[n].filter((t=>t.lu>=e)),i[n].length&&i[n][0].lu===e)continue;const s=t[t.length-1];s.lu=e,i[n].unshift(s)}}return this.combinedHistory=i,this.combinedHistory}}const _=(t,e,i,n,s=!0,o=!0,r)=>{const a={type:"history/stream",entity_ids:n,start_time:new Date((new Date).getTime()-3600*i*1e3).toISOString(),minimal_response:s,significant_changes_only:o,no_attributes:r??!n.some((e=>h(t,e)))},c=new f(t,i);return t.connection.subscribeMessage((t=>e(c.processMessage(t))),a)},m=(t,e)=>t.state===e.state&&(!t.attributes||!e.attributes||d.every((i=>t.attributes[i]===e.attributes[i]))),y=(t,e,i,n,s,a,c)=>{const u=[],d=a[0];for(const r of a){if(u.length>0&&r.s===u[u.length-1].state)continue;const a={};c?.attributes.device_class&&(a.device_class=c?.attributes.device_class),u.push({state_localize:(0,o.c)(t,e,[],i,n[s],s,{...r.a||d.a,...a},r.s),state:r.s,last_changed:1e3*(r.lc?r.lc:r.lu)})}return{name:(0,r.a)(s,c?.attributes||d.a),entity_id:s,data:u}},b=(t,e,i,n)=>{const o=[];return Object.keys(i).forEach((t=>{const e=i[t],a=e[0],u=(0,s.M)(t),h=[];for(const t of e){let e;if(c.includes(u)){e={state:t.s,last_changed:1e3*t.lu,attributes:{}};for(const i of d)i in t.a&&(e.attributes[i]=t.a[i])}else e={state:t.s,last_changed:1e3*(t.lc?t.lc:t.lu),attributes:{}};h.length>1&&m(e,h[h.length-1])&&m(e,h[h.length-2])||h.push(e)}const l=t in n?n[t].attributes:"friendly_name"in a.a?a.a:void 0;o.push({domain:u,name:(0,r.a)(t,l||{}),entity_id:t,states:h})})),{unit:t,device_class:e,identifier:Object.keys(i).join(""),data:o}},g=["counter","input_number","number"],p=t=>g.includes(t),k=t=>"unit_of_measurement"in t||"state_class"in t,v=(t,e)=>null!=t.attributes.device_class&&e.includes(t.attributes.device_class),w=" ",H=(t,e,i,n,o,r=!1,a=!1)=>{const c={},u=[],d={};if(new Set([...i,...Object.keys(e)]).forEach((i=>{i in e?d[i]=e[i]:t.states[i]&&(d[i]=[{s:t.states[i].state,a:t.states[i].attributes,lu:new Date(t.states[i].last_updated).getTime()/1e3}])})),!d)return{line:[],timeline:[]};Object.keys(d).forEach((e=>{const i=d[e];if(0===i.length)return;const h=(0,s.M)(e),l=e in t.states?t.states[e]:void 0,f=l||p(h)?void 0:i.find((t=>t.a&&k(t.a)));let _;_=a||p(h)||null!=l&&k(l.attributes)||null!=l&&"sensor"===h&&v(l,o)||null!=f?l?.attributes.unit_of_measurement||f?.a.unit_of_measurement||w:{zone:n("ui.dialogs.more_info_control.zone.graph_unit"),climate:t.config.unit_system.temperature,humidifier:"%",water_heater:t.config.unit_system.temperature}[h];const m=$(_,{climate:"temperature",humidifier:"humidity",water_heater:"temperature"}[h]||(l?.attributes||f?.a)?.device_class,r);_?m&&m in c&&e in c[m]?c[m][e].push(...i):m&&(m in c||(c[m]={}),c[m][e]=i):u.push(y(n,t.locale,t.config,t.entities,e,i,l))}));return{line:Object.keys(c).map((e=>{const i=e.split("_"),n=i[0],s=i[1]||void 0;return b(n,s,c[e],t.states)})),timeline:u}},$=(t,e,i)=>i?`${t}_${e||""}`:t;n()}catch(t){n(t)}}))},11823:function(t,e,i){i.a(t,(async function(t,n){try{i.r(e),i.d(e,{DEFAULT_HOURS_TO_SHOW:function(){return w},DEFAULT_ZOOM:function(){return H}});var s=i(44249),o=i(72621),r=(i(92745),i(39527),i(67670),i(13334),i(57243)),a=i(15093),c=i(27486),u=i(50875),d=i(72344),h=i(73850),l=i(47194),f=i(48045),_=i(74564),m=(i(99426),i(54977),i(23334),i(65986)),y=i(6280),b=i(69223),g=i(93331),p=i(29401),k=t([m,y]);[m,y]=k.then?(await k)():k;const v="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,19H15V21H19A2,2 0 0,0 21,19V15H19M19,3H15V5H19V9H21V5A2,2 0 0,0 19,3M5,5H9V3H5A2,2 0 0,0 3,5V9H5M5,15H3V19A2,2 0 0,0 5,21H9V19H5V15Z",w=0,H=14;(0,s.Z)([(0,a.Mo)("hui-map-card")],(function(t,e){class n extends e{constructor(...e){super(...e),t(this)}}return{F:n,d:[{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"layout",value:void 0},{kind:"field",decorators:[(0,a.SB)()],key:"_stateHistory",value:void 0},{kind:"field",decorators:[(0,a.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,a.IO)("ha-map")],key:"_map",value:void 0},{kind:"field",key:"_configEntities",value:void 0},{kind:"field",decorators:[(0,a.SB)()],key:"_mapEntities",value:()=>[]},{kind:"field",key:"_colorDict",value:()=>({})},{kind:"field",key:"_colorIndex",value:()=>0},{kind:"field",decorators:[(0,a.SB)()],key:"_error",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"method",key:"setConfig",value:function(t){if(!t)throw new Error("Error in card configuration.");if(!t.entities?.length&&!t.geo_location_sources)throw new Error("Either entities or geo_location_sources must be specified");if(t.entities&&!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(t.geo_location_sources&&!Array.isArray(t.geo_location_sources))throw new Error("Parameter geo_location_sources needs to be an array");this._config=t,this._configEntities=t.entities?(0,p.A)(t.entities):[],this._mapEntities=this._getMapEntities()}},{kind:"method",key:"getCardSize",value:function(){if(!this._config?.aspect_ratio)return 7;const t=(0,_.Z)(this._config.aspect_ratio),e=t&&t.w>0&&t.h>0?`${(100*t.h/t.w).toFixed(2)}`:"100";return 1+Math.floor(Number(e)/25)||3}},{kind:"method",static:!0,key:"getConfigElement",value:async function(){return await Promise.all([i.e("46379"),i.e("24199"),i.e("27506"),i.e("41258"),i.e("7010"),i.e("62524"),i.e("67390"),i.e("3049"),i.e("47818"),i.e("98815")]).then(i.bind(i,96216)),document.createElement("hui-map-card-editor")}},{kind:"method",static:!0,key:"getStubConfig",value:function(t,e,i){return{type:"map",entities:(0,b.j)(t,2,e,i,["device_tracker"]),theme_mode:"auto"}}},{kind:"method",key:"render",value:function(){if(!this._config)return r.Ld;if(this._error)return r.dy`<ha-alert alert-type="error"> ${this.hass.localize("ui.components.map.error")}: ${this._error.message} (${this._error.code}) </ha-alert>`;const t=!(!this._config.dark_mode&&"dark"!==this._config.theme_mode)||"light"!==this._config.theme_mode&&this.hass.themes.darkMode,e=this._config.theme_mode||(this._config.dark_mode?"dark":"auto");return r.dy` <ha-card id="card" .header="${this._config.title}"> <div id="root"> <ha-map .hass="${this.hass}" .entities="${this._mapEntities}" .zoom="${this._config.default_zoom??H}" .paths="${this._getHistoryPaths(this._config,this._stateHistory)}" .autoFit="${this._config.auto_fit||!1}" .fitZones="${this._config.fit_zones}" .themeMode="${e}" interactive-zones render-passive></ha-map> <ha-icon-button .label="${this.hass.localize("ui.panel.lovelace.cards.map.reset_focus")}" .path="${v}" style="${t?"color:#ffffff":"color:#000000"}" @click="${this._fitMap}" tabindex="0"></ha-icon-button> </div> </ha-card> `}},{kind:"method",key:"shouldUpdate",value:function(t){if(!t.has("hass")||t.size>1)return!0;const e=t.get("hass");return!e||!this._configEntities||(e.themes.darkMode!==this.hass.themes.darkMode||(!!t.has("_stateHistory")||(!(!this._config?.geo_location_sources||e.states===this.hass.states)||(this._config?.entities?(0,g.Wh)(this,t):(0,g.SN)(this,t)))))}},{kind:"method",key:"willUpdate",value:function(t){(0,o.Z)(n,"willUpdate",this,3)([t]),t.has("hass")&&this._config?.geo_location_sources&&!(0,f.v)(this._getSourceEntities(t.get("hass")?.states),this._getSourceEntities(this.hass.states))&&(this._mapEntities=this._getMapEntities())}},{kind:"method",key:"connectedCallback",value:function(){(0,o.Z)(n,"connectedCallback",this,3)([]),this.hasUpdated&&this._configEntities?.length&&this._subscribeHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,o.Z)(n,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{kind:"method",key:"_subscribeHistory",value:function(){(0,d.p)(this.hass,"history")&&!this._subscribed&&(this._config?.hours_to_show??w)&&(this._subscribed=(0,y.xS)(this.hass,(t=>{this._subscribed&&(this._stateHistory=t)}),this._config.hours_to_show??w,(this._configEntities||[]).map((t=>t.entity)),!1,!1,!1).catch((t=>{this._subscribed=void 0,this._error=t})))}},{kind:"method",key:"_unsubscribeHistory",value:function(){this._subscribed&&(this._subscribed.then((t=>t?.())),this._subscribed=void 0)}},{kind:"method",key:"updated",value:function(t){this._configEntities?.length?this._subscribed&&!t.has("_config")||(this._unsubscribeHistory(),this._subscribeHistory()):this._unsubscribeHistory(),t.has("_config")&&this._computePadding()}},{kind:"method",key:"_computePadding",value:function(){const t=this.shadowRoot.getElementById("root"),e="panel"===this.layout||"grid"===this.layout;if(!this._config||e||!t)return;if(!this._config.aspect_ratio)return void(t.style.paddingBottom="100%");t.style.height="auto";const i=(0,_.Z)(this._config.aspect_ratio);t.style.paddingBottom=i&&i.w>0&&i.h>0?`${(100*i.h/i.w).toFixed(2)}%`:t.style.paddingBottom="100%"}},{kind:"method",key:"_fitMap",value:function(){this._map?.fitMap()}},{kind:"method",key:"_getColor",value:function(t){let e=this._colorDict[t];return e||(e=(0,u.Eu)(this._colorIndex),this._colorIndex++,this._colorDict[t]=e,e)}},{kind:"method",key:"_getSourceEntities",value:function(t){if(!t||!this._config?.geo_location_sources)return[];const e=this._config.geo_location_sources.map((t=>"string"==typeof t?{source:t}:t)),i=[],n=e.find((t=>"all"===t.source));for(const s of Object.values(t)){const t=e.find((t=>t.source===s.attributes.source));"geo_location"===(0,h.M)(s.entity_id)&&(n||t)&&i.push({entity_id:s.entity_id,label_mode:t?.label_mode??n?.label_mode,focus:t?t.focus??!0:n?.focus??!0})}return i}},{kind:"method",key:"_getMapEntities",value:function(){return[...(this._configEntities||[]).map((t=>({entity_id:t.entity,color:this._getColor(t.entity),label_mode:t.label_mode,focus:t.focus,name:t.name}))),...this._getSourceEntities(this.hass?.states).map((t=>({...t,color:this._getColor(t.entity_id)})))]}},{kind:"field",key:"_getHistoryPaths",value(){return(0,c.Z)(((t,e)=>{if(!e||!(t.hours_to_show??w))return;const i=[];for(const n of Object.keys(e)){if("zone"===(0,h.M)(n))continue;const s=e[n];if(!s?.length)continue;const o=[];for(const t of s){const e=t.a.latitude,i=t.a.longitude;if(!e||!i)continue;const n={};n.point=[e,i],n.timestamp=new Date(1e3*t.lu),o.push(n)}const r=this._configEntities?.find((t=>t.entity===n)),a=r?.name??(n in this.hass.states?(0,l.C)(this.hass.states[n]):n);i.push({points:o,name:a,fullDatetime:(t.hours_to_show??w)>144,color:this._getColor(n),gradualOpacity:.8})}return i}))}},{kind:"method",key:"getGridOptions",value:function(){return{columns:"full",rows:4,min_columns:6,min_rows:2}}},{kind:"get",static:!0,key:"styles",value:function(){return r.iv`ha-card{overflow:hidden;width:100%;height:100%;display:flex;flex-direction:column}ha-map{z-index:0;border:none;position:absolute;top:0;left:0;width:100%;height:100%;background:inherit}ha-icon-button{position:absolute;top:75px;left:3px;outline:0}#root{position:relative;height:100%}`}}]}}),r.oi);n()}catch(t){n(t)}}))},41924:function(t,e,i){i.d(e,{y:function(){return s}});var n=i(53907);function s(t){return(0,n.L)(t,Date.now())}},97836:function(t,e,i){i.d(e,{K:function(){return o}});var n=i(18492),s=i(7591);function o(t,e,i){const[o,r]=(0,n.d)(i?.in,t,e);return+(0,s.b)(o)==+(0,s.b)(r)}},16444:function(t,e,i){i.d(e,{z:function(){return r}});var n=i(53907),s=i(41924),o=i(97836);function r(t,e){return(0,o.K)((0,n.L)(e?.in||t,t),(0,s.y)(e?.in||t))}}};
//# sourceMappingURL=48240.5c76e38df3f32b4b.js.map