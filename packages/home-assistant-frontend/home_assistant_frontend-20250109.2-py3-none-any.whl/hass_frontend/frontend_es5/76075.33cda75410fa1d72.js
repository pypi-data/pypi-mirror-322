"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["76075"],{95262:function(e,t,n){function i(e){return null==e||Array.isArray(e)?e:[e]}n.d(t,{r:function(){return i}})},92636:function(e,t,n){n.d(t,{z:function(){return i}});n(19083),n(61006);const i=e=>(t,n)=>e.includes(t,n)},14473:function(e,t,n){n.d(t,{B$:function(){return c},EQ:function(){return y},Es:function(){return d},Gd:function(){return u},HF:function(){return b},Ip:function(){return w},J8:function(){return A},Kc:function(){return h},Pl:function(){return j},SC:function(){return l},SQ:function(){return p},W9:function(){return v},Xm:function(){return E},Yc:function(){return a},r4:function(){return g},sq:function(){return _}});n(71695),n(92745),n(19423),n(39527),n(41360),n(13334),n(47021);var i=n(83523),r=n(95262),o=n(68418),s=n(58776);const c="single",a=10,u=e=>{if("condition"in e&&Array.isArray(e.condition))return{condition:"and",conditions:e.condition};for(const t of["and","or","not"])if(t in e)return{condition:t,conditions:e[t]};return e},d=(e,t)=>{e.callService("automation","trigger",{entity_id:t,skip_condition:!0})},l=(e,t)=>e.callApi("DELETE",`config/automation/config/${t}`);let f;const g=(e,t)=>e.callApi("GET",`config/automation/config/${t}`),p=(e,t)=>e.callWS({type:"automation/config",entity_id:t}),_=(e,t,n)=>e.callApi("POST",`config/automation/config/${t}`,n),y=e=>{e=m(e);for(const t of["triggers","conditions","actions"]){const n=e[t];n&&!Array.isArray(n)&&(e[t]=[n])}return e},m=e=>("trigger"in e&&("triggers"in e||(e.triggers=e.trigger),delete e.trigger),"condition"in e&&("conditions"in e||(e.conditions=e.condition),delete e.condition),"action"in e&&("actions"in e||(e.actions=e.action),delete e.action),e.triggers&&(e.triggers=v(e.triggers)),e.actions&&(e.actions=(0,o.eR)(e.actions)),e),v=e=>e?Array.isArray(e)?e.map(v):("triggers"in e&&e.triggers&&(e.triggers=v(e.triggers)),"platform"in e&&("trigger"in e||(e.trigger=e.platform),delete e.platform),e):e,h=e=>{if(!e)return[];const t=[];return(0,r.r)(e).forEach((e=>{"triggers"in e?e.triggers&&t.push(...h(e.triggers)):t.push(e)})),t},w=(e,t)=>{f=e;const n=t?`?${(0,s.ou)({expanded:"1"})}`:"";(0,i.c)(`/config/automation/edit/new${n}`)},b=e=>{w(Object.assign(Object.assign({},e),{},{id:void 0,alias:void 0}))},j=()=>{const e=f;return f=void 0,e},E=(e,t,n,i)=>e.connection.subscribeMessage(t,{type:"subscribe_trigger",trigger:n,variables:i}),A=(e,t,n)=>e.callWS({type:"test_condition",condition:t,variables:n})},68418:function(e,t,n){n.d(t,{EH:function(){return u},FI:function(){return j},Kx:function(){return f},Pw:function(){return E},TL:function(){return g},eM:function(){return w},eR:function(){return Z},kC:function(){return _},oE:function(){return h},oR:function(){return m},rg:function(){return b},rq:function(){return y},sf:function(){return A},vA:function(){return d}});n(71695),n(13334),n(47021);var i=n(62900),r=n(92636),o=n(83523),s=n(14473),c=n(97969),a=n(58776);const u=["single","restart","queued","parallel"],d=(0,r.z)(["queued","parallel"]),l=(0,i.Ry)({alias:(0,i.jt)((0,i.Z_)()),continue_on_error:(0,i.jt)((0,i.O7)()),enabled:(0,i.jt)((0,i.O7)())}),f=(0,i.Ry)({entity_id:(0,i.jt)((0,i.G0)([(0,i.Z_)(),(0,i.IX)((0,i.Z_)())])),device_id:(0,i.jt)((0,i.G0)([(0,i.Z_)(),(0,i.IX)((0,i.Z_)())])),area_id:(0,i.jt)((0,i.G0)([(0,i.Z_)(),(0,i.IX)((0,i.Z_)())])),floor_id:(0,i.jt)((0,i.G0)([(0,i.Z_)(),(0,i.IX)((0,i.Z_)())])),label_id:(0,i.jt)((0,i.G0)([(0,i.Z_)(),(0,i.IX)((0,i.Z_)())]))}),g=(0,i.f0)(l,(0,i.Ry)({action:(0,i.jt)((0,i.Z_)()),service_template:(0,i.jt)((0,i.Z_)()),entity_id:(0,i.jt)((0,i.Z_)()),target:(0,i.jt)(f),data:(0,i.jt)((0,i.Ry)()),response_variable:(0,i.jt)((0,i.Z_)()),metadata:(0,i.jt)((0,i.Ry)())})),p=(0,i.f0)(l,(0,i.Ry)({action:(0,i.i0)("media_player.play_media"),target:(0,i.jt)((0,i.Ry)({entity_id:(0,i.jt)((0,i.Z_)())})),entity_id:(0,i.jt)((0,i.Z_)()),data:(0,i.Ry)({media_content_id:(0,i.Z_)(),media_content_type:(0,i.Z_)()}),metadata:(0,i.Ry)()})),_=(e,t,n)=>e.callService("script",t,n),y=e=>"off"===e.state||!!("on"===e.state&&d(e.attributes.mode)&&e.attributes.current<e.attributes.max),m=(e,t)=>e.callApi("DELETE",`config/script/config/${t}`);let v;const h=(e,t)=>e.callApi("GET",`config/script/config/${t}`),w=(e,t)=>e.callWS({type:"script/config",entity_id:t}),b=(e,t)=>{v=e;const n=t?`?${(0,a.ou)({expanded:"1"})}`:"";(0,o.c)(`/config/script/edit/new${n}`)},j=()=>{const e=v;return v=void 0,e},E=e=>"delay"in e?"delay":"wait_template"in e?"wait_template":["condition","and","or","not"].some((t=>t in e))?"check_condition":"event"in e?"fire_event":"device_id"in e?"device_action":"repeat"in e?"repeat":"choose"in e?"choose":"if"in e?"if":"wait_for_trigger"in e?"wait_for_trigger":"variables"in e?"variables":"stop"in e?"stop":"sequence"in e?"sequence":"parallel"in e?"parallel":"set_conversation_response"in e?"set_conversation_response":"action"in e||"service"in e?"metadata"in e&&(0,i.is)(e,p)?"play_media":"service":"unknown",A=(e,t)=>{var n;const i=null===(n=e.services.script[(0,c.p)(t)])||void 0===n?void 0:n.fields;return void 0!==i&&Object.keys(i).length>0},Z=e=>{if(!e)return e;if(Array.isArray(e))return e.map(Z);if("service"in e&&("action"in e||(e.action=e.service),delete e.service),"scene"in e&&(e.action="scene.turn_on",e.target={entity_id:e.scene},delete e.scene),"sequence"in e)for(const n of e.sequence)Z(n);const t=E(e);if("parallel"===t){Z(e.parallel)}if("choose"===t){const t=e;if(Array.isArray(t.choose))for(const e of t.choose)Z(e.sequence);else t.choose&&Z(t.choose.sequence);t.default&&Z(t.default)}if("repeat"===t){Z(e.repeat.sequence)}if("if"===t){const t=e;Z(t.then),t.else&&Z(t.else)}if("wait_for_trigger"===t){const t=e;(0,s.W9)(t.wait_for_trigger)}return e}},41259:function(e,t,n){n.r(t),n.d(t,{addExternalBarCodeListener:function(){return a},attachExternalToApp:function(){return c}});n(71695),n(92519),n(42179),n(89256),n(24931),n(88463),n(57449),n(19814),n(39527),n(41360),n(47021);var i=n(36522),r=n(5111),o=n(14473);const s=new Set,c=e=>{window.addEventListener("haptic",(t=>e.hass.auth.external.fireMessage({type:"haptic",payload:{hapticType:t.detail}}))),e.hass.auth.external.addCommandHandler((t=>u(e,t)))},a=e=>(s.add(e),()=>{s.delete(e)}),u=(e,t)=>{const n=e.hass.auth.external;if("restart"===t.command)e.hass.connection.reconnect(!0),n.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("notifications/show"===t.command)(0,i.B)(e,"hass-show-notifications"),n.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("sidebar/toggle"===t.command){var c;if(null!==(c=r.E.history.state)&&void 0!==c&&c.open)return n.fireMessage({id:t.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,i.B)(e,"hass-toggle-menu"),n.fireMessage({id:t.id,type:"result",success:!0,result:null})}else if("sidebar/show"===t.command){var a;if(null!==(a=r.E.history.state)&&void 0!==a&&a.open)return n.fireMessage({id:t.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,i.B)(e,"hass-toggle-menu",{open:!0}),n.fireMessage({id:t.id,type:"result",success:!0,result:null})}else if("automation/editor/show"===t.command){var u;(0,o.Ip)(null===(u=t.payload)||void 0===u?void 0:u.config),n.fireMessage({id:t.id,type:"result",success:!0,result:null})}else if("improv/discovered_device"===t.command)(0,i.B)(window,"improv-discovered-device",t.payload),n.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("improv/device_setup_done"===t.command)(0,i.B)(window,"improv-device-setup-done"),n.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("bar_code/scan_result"===t.command)s.forEach((e=>e(t))),n.fireMessage({id:t.id,type:"result",success:!0,result:null});else{if("bar_code/aborted"!==t.command)return!1;s.forEach((e=>e(t))),n.fireMessage({id:t.id,type:"result",success:!0,result:null})}return!0}}}]);
//# sourceMappingURL=76075.33cda75410fa1d72.js.map