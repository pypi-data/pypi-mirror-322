export const ids=["51439"];export const modules={50875:function(t,e,n){n.d(e,{Eu:function(){return a},hZ:function(){return o}});var s=n(11259);const i=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function a(t){return i[t%i.length]}function o(t,e){const n=e.getPropertyValue(`--graph-color-${t+1}`)||a(t);return(0,s.Rq)(n)}},68958:function(t,e,n){n.d(e,{t:function(){return a}});n(92745),n(39527),n(41360),n(88972);class s{constructor(t=window.localStorage){this.storage=void 0,this._storage={},this._listeners={},this.storage=t,t===window.localStorage&&window.addEventListener("storage",(t=>{t.key&&this.hasKey(t.key)&&(this._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,this._listeners[t.key]&&this._listeners[t.key].forEach((e=>e(t.oldValue?JSON.parse(t.oldValue):t.oldValue,this._storage[t.key]))))}))}addFromStorage(t){if(!this._storage[t]){const e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}subscribeChanges(t,e){return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],()=>{this.unsubscribeChanges(t,e)}}unsubscribeChanges(t,e){if(!(t in this._listeners))return;const n=this._listeners[t].indexOf(e);-1!==n&&this._listeners[t].splice(n,1)}hasKey(t){return t in this._storage}getValue(t){return this._storage[t]}setValue(t,e){const n=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(t){}finally{this._listeners[t]&&this._listeners[t].forEach((t=>t(n,e)))}}}const i={},a=t=>e=>{const n=t.storage||"localStorage";let a;n&&n in i?a=i[n]:(a=new s(window[n]),i[n]=a);const o=String(e.key),r=t.key||String(e.key),c=e.initializer?e.initializer():void 0;a.addFromStorage(r);const d=!1!==t.subscribe?t=>a.subscribeChanges(r,((n,s)=>{t.requestUpdate(e.key,n)})):void 0,u=()=>a.hasKey(r)?t.deserializer?t.deserializer(a.getValue(r)):a.getValue(r):c;return{kind:"method",placement:"prototype",key:e.key,descriptor:{set(n){((n,s)=>{let i;t.state&&(i=u()),a.setValue(r,t.serializer?t.serializer(s):s),t.state&&n.requestUpdate(e.key,i)})(this,n)},get:()=>u(),enumerable:!0,configurable:!0},finisher(n){if(t.state&&t.subscribe){const t=n.prototype.connectedCallback,e=n.prototype.disconnectedCallback;n.prototype.connectedCallback=function(){t.call(this),this[`__unbsubLocalStorage${o}`]=d?.(this)},n.prototype.disconnectedCallback=function(){e.call(this),this[`__unbsubLocalStorage${o}`]?.(),this[`__unbsubLocalStorage${o}`]=void 0}}t.state&&n.createProperty(e.key,{noAccessor:!0,...t.stateOptions})}}}},18520:function(t,e,n){n.d(e,{n:function(){return s}});const s=t=>!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType},6736:function(t,e,n){n.d(e,{f:function(){return o}});var s=n(44249),i=n(72621),a=(n(39527),n(36993),n(15093));const o=t=>(0,s.Z)(null,(function(t,e){class n extends e{constructor(...e){super(...e),t(this)}}return{F:n,d:[{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,i.Z)(n,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,i.Z)(n,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const t=this.__unsubs.pop();t instanceof Promise?t.then((t=>t())):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,i.Z)(n,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const e of t.keys())if(this.hassSubscribeRequiredHostProps.includes(e))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&!this.hassSubscribeRequiredHostProps?.some((t=>void 0===this[t]))&&(this.__unsubs=this.hassSubscribe())}}]}}),t)},20548:function(t,e,n){n.d(e,{H:function(){return a}});var s=n(11259),i=n(4643);function a(t,e,n,a,o,r){const c=t.getPropertyValue(o+"-"+r).trim(),d=c.length>0?c:t.getPropertyValue(o).trim();let u=(0,s.Rq)(d);return 0===c.length&&r&&(u=(0,s.CO)((0,s.p3)(e?(0,i.C)((0,s.Rw)((0,s.wK)(u)),r):(0,i.W)((0,s.Rw)((0,s.wK)(u)),r)))),a?u+=n?"32":"7F":n&&(u+="7F"),u}},53259:function(t,e,n){n.a(t,(async function(t,s){try{n.d(e,{J:function(){return f}});var i=n(21893),a=n(13809),o=n(13633),r=n(38836),c=n(50602),d=n(46467),u=n(33570),h=t([d,u,c]);function l(t,e){let n=new Date(e);return t>2&&0===n.getHours()&&(n=(0,i.b)(n,1)),n.setMinutes(0,0,0),t>35&&n.setDate(1),t>2&&n.setHours(0),n.getTime()}function f(t,e,n,s,i,h,f){const p=(0,a.j)(e,t),_=void 0!==h&&void 0!==f;if(_&&p<=35){const n=(0,o.A)(e,t),s=(0,o.A)(f,h);s>n?e=(0,r.T)(e,s-n):n>s&&(f=(0,r.T)(f,n-s))}const k={parsing:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:l(p,e),adapters:{date:{locale:n,config:s}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},time:{tooltipFormat:p>35?"monthyear":p>7?"date":p>2?"weekday":p>0?"datetime":"hour",minUnit:p>35?"month":p>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:t=>(0,c.uf)(Math.abs(t),n)}}},plugins:{tooltip:{position:"nearest",filter:t=>"0"!==t.formattedValue,itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:t=>{if(p>0)return t[0].label;const e=new Date(t[0].parsed.x);return`${_?`${(0,d.ud)(e,n,s)}: `:""}${(0,u.mr)(e,n,s)} â€“ ${(0,u.mr)((0,r.T)(e,1),n,s)}`},label:t=>`${t.dataset.label}: ${(0,c.uf)(t.parsed.y,n)} ${i}`}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,c.Hd)(n)};return _&&(k.scales.xAxisCompare={...k.scales.x,suggestedMin:h.getTime(),max:l(p,f),display:!1}),k}[d,u,c]=h.then?(await h)():h,s()}catch(p){s(p)}}))},36681:function(t,e,n){n.a(t,(async function(t,s){try{n.r(e),n.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return x}});var i=n(44249),a=(n(92745),n(39527),n(99790),n(41360),n(13334),n(42625)),o=n(83389),r=n(57243),c=n(15093),d=n(35359),u=n(27486),h=n(50875),l=n(20548),f=(n(54977),n(29937),n(1118)),p=n(17705),_=n(6736),k=n(93331),b=n(53259),g=n(36522),m=n(68958),v=n(18520),y=t([b,f]);[b,f]=y.then?(await y)():y;const S="kWh";let x=(0,i.Z)([(0,c.Mo)("hui-energy-devices-detail-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,c.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_chartData",value:()=>({datasets:[]})},{kind:"field",decorators:[(0,c.SB)()],key:"_chartDatasetExtra",value:()=>[]},{kind:"field",decorators:[(0,c.SB)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_start",value:()=>(0,a.I)()},{kind:"field",decorators:[(0,c.SB)()],key:"_end",value:()=>(0,o.p)()},{kind:"field",decorators:[(0,c.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,m.t)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:()=>[]},{kind:"field",key:"_untrackedIndex",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,f.UB)(this.hass,{key:this._config?.collection_key}).subscribe((t=>{this._data=t,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,k.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?r.dy` <ha-card> ${this._config.title?r.dy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,d.$)({"has-header":!!this._config.title})}"> <ha-chart-base external-hidden .hass="${this.hass}" .data="${this._chartData}" .extraData="${this._chartDatasetExtra}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,S,this._compareStart,this._compareEnd)}" chart-type="bar" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:r.Ld}},{kind:"method",key:"_datasetHidden",value:function(t){const e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=[...this._hiddenStats,e]}},{kind:"method",key:"_datasetUnhidden",value:function(t){const e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=this._hiddenStats.filter((t=>t!==e))}},{kind:"field",key:"_createOptions",value(){return(0,u.Z)(((t,e,n,s,i,a,o)=>{const r=(0,b.J)(t,e,n,s,i,a,o);return{...r,interaction:{mode:"nearest"},plugins:{...r.plugins,legend:{display:!0,labels:{usePointStyle:!0}}},onClick:(t,e,n)=>{if((0,v.n)(t))return;const s=e[0]?.datasetIndex??-1;if(s<0)return;const i=this._data?.prefs.device_consumption[s]?.stat_consumption;i&&!(0,p.Hs)(i)&&((0,g.B)(this,"hass-more-info",{entityId:i}),n?.canvas?.dispatchEvent(new Event("mouseout")))}}}))}},{kind:"method",key:"_processStatistics",value:function(){const t=this._data,e=t.stats,n=t.statsCompare,s=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((t=>{const n=t.stat_consumption in e&&(0,p.Kj)(e[t.stat_consumption])||0;i[t.stat_consumption]=n}));const a=t.prefs.device_consumption.map((t=>t.stat_consumption));a.sort(((t,e)=>i[e]-i[t]));const r=[],c=[],{data:d,dataExtras:u}=this._processDataSet(s,e,t.statsMetadata,t.prefs.device_consumption,a);r.push(...d),c.push(...u);const{summedData:h,compareSummedData:l}=(0,f.EH)(t),_="from_grid"in h||"solar"in h||"from_battery"in h,{consumption:k,compareConsumption:b}=_?(0,f.E4)(h,l):{consumption:void 0,compareConsumption:void 0};if(_){this._untrackedIndex=r.length;const{dataset:t,datasetExtra:e}=this._processUntracked(s,d,k,!1);r.push(t),c.push(e)}if(n){r.push({order:0,data:[]}),c.push({show_legend:!1}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),c.push({show_legend:!1});const{data:e,dataExtras:i}=this._processDataSet(s,n,t.statsMetadata,t.prefs.device_consumption,a,!0);if(r.push(...e),c.push(...i),_){const{dataset:t,datasetExtra:n}=this._processUntracked(s,e,b,!0);r.push(t),c.push(n)}}this._start=t.start,this._end=t.end||(0,o.p)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:r},this._chartDatasetExtra=c}},{kind:"method",key:"_processUntracked",value:function(t,e,n,s){const i={};e.forEach((t=>{t.data.forEach((t=>{i[t.x]=(i[t.x]||0)+t.y}))}));const a=[];Object.keys(n.total).forEach((t=>{a.push({x:Number(t),y:n.total[t]-(i[t]||0)})}));return{dataset:{label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),hidden:this._hiddenStats.includes("untracked"),borderColor:(0,l.H)(t,this.hass.themes.darkMode,!1,s,"--state-unavailable-color"),backgroundColor:(0,l.H)(t,this.hass.themes.darkMode,!0,s,"--state-unavailable-color"),data:a,order:1+this._untrackedIndex,stack:"devices",pointStyle:!s&&"circle",xAxisID:s?"xAxisCompare":void 0},datasetExtra:{show_legend:!s}}}},{kind:"method",key:"_processDataSet",value:function(t,e,n,s,i,a=!1){const o=[],r=[];return s.forEach(((s,c)=>{const d=(0,h.hZ)(c,t);let u=null;const l=[];if(s.stat_consumption in e){const t=e[s.stat_consumption];let n;for(const e of t){if(null===e.change||void 0===e.change)continue;if(u===e.start)continue;const t=new Date(e.start);l.push({x:t.getTime(),y:e.change}),u=e.start,n=e.end}1===l.length&&l.push({x:n,y:0})}const f=i.indexOf(s.stat_consumption),_=!!(this._config?.max_devices&&f>=this._config.max_devices);o.push({label:s.name||(0,p.Kd)(this.hass,s.stat_consumption,n[s.stat_consumption]),hidden:this._hiddenStats.includes(s.stat_consumption)||_,borderColor:a?d+"7F":d,backgroundColor:a?d+"32":d+"7F",data:l,order:1+f,stack:"devices",pointStyle:!a&&"circle",xAxisID:a?"xAxisCompare":void 0}),r.push({show_legend:!a&&!_})})),{data:o,dataExtras:r}}},{kind:"get",static:!0,key:"styles",value:function(){return r.iv`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}}]}}),(0,_.f)(r.oi));s()}catch(t){s(t)}}))},32424:function(t,e,n){n.d(e,{E:function(){return a}});var s=n(53907),i=n(18112);function a(t,e,n){const a=(0,i.Q)(t,n?.in);return isNaN(e)?(0,s.L)(n?.in||t,NaN):e?(a.setDate(a.getDate()+e),a):a}},38836:function(t,e,n){n.d(e,{T:function(){return a}});var s=n(23711),i=n(76808);function a(t,e,n){return(0,s.n)(t,e*i.vh,n)}},23711:function(t,e,n){n.d(e,{n:function(){return a}});var s=n(53907),i=n(18112);function a(t,e,n){return(0,s.L)(n?.in||t,+(0,i.Q)(t)+e)}},23459:function(t,e,n){n.d(e,{z:function(){return a}});var s=n(53907),i=n(18112);function a(t,e,n){const a=(0,i.Q)(t,n?.in);if(isNaN(e))return(0,s.L)(n?.in||t,NaN);if(!e)return a;const o=a.getDate(),r=(0,s.L)(n?.in||t,a.getTime());r.setMonth(a.getMonth()+e+1,0);return o>=r.getDate()?r:(a.setFullYear(r.getFullYear(),r.getMonth(),o),a)}},2425:function(t,e,n){n.d(e,{U:function(){return i}});var s=n(18112);function i(t,e){const n=+(0,s.Q)(t)-+(0,s.Q)(e);return n<0?-1:n>0?1:n}},13633:function(t,e,n){n.d(e,{A:function(){return o}});var s=n(34151),i=n(18492),a=n(76808);function o(t,e,n){const[o,r]=(0,i.d)(n?.in,t,e),c=(+o-+r)/a.vh;return(0,s.u)(n?.roundingMethod)(c)}},14276:function(t,e,n){n.d(e,{_:function(){return i}});var s=n(18112);function i(t,e){return+(0,s.Q)(t)-+(0,s.Q)(e)}},6542:function(t,e,n){n.d(e,{d:()=>r});var s=n("18492"),i=n("2425");function a(t,e,n){const[i,a]=(0,s.d)(n?.in,t,e);return 12*(i.getFullYear()-a.getFullYear())+(i.getMonth()-a.getMonth())}var o=n("3938");function r(t,e,n){const[r,c,d]=(0,s.d)(n?.in,t,t,e),u=(0,i.U)(c,d),h=Math.abs(a(c,d));if(h<1)return 0;1===c.getMonth()&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-u*h);let l=(0,i.U)(c,d)===-u;(0,o.h)(r)&&1===h&&1===(0,i.U)(r,d)&&(l=!1);const f=u*(h-+l);return 0===f?0:f}},96500:function(t,e,n){n.d(e,{i:function(){return i}});var s=n(18112);function i(t,e){const n=(0,s.Q)(t,e?.in);return n.setHours(23,59,59,999),n}},2621:function(t,e,n){n.d(e,{V:function(){return i}});var s=n(18112);function i(t,e){const n=(0,s.Q)(t,e?.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}},83389:function(t,e,n){n.d(e,{p:function(){return i}});var s=n(96500);function i(t){return(0,s.i)(Date.now(),t)}},86319:function(t,e,n){n.d(e,{b:function(){return i}});var s=n(18112);function i(t,e){return 1===(0,s.Q)(t,e?.in).getDate()}},3938:function(t,e,n){n.d(e,{h:function(){return o}});var s=n(96500),i=n(2621),a=n(18112);function o(t,e){const n=(0,a.Q)(t,e?.in);return+(0,s.i)(n,e)==+(0,i.V)(n,e)}},42625:function(t,e,n){n.d(e,{I:function(){return i}});var s=n(7591);function i(t){return(0,s.b)(Date.now(),t)}},21893:function(t,e,n){n.d(e,{b:function(){return i}});var s=n(38836);function i(t,e,n){return(0,s.T)(t,-e,n)}}};
//# sourceMappingURL=51439.db9278714ce1021d.js.map