"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["34321"],{50875:function(t,e,n){n.d(e,{Eu:function(){return a},hZ:function(){return o}});var i=n(11259);const s=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function a(t){return s[t%s.length]}function o(t,e){const n=e.getPropertyValue(`--graph-color-${t+1}`)||a(t);return(0,i.Rq)(n)}},18520:function(t,e,n){n.d(e,{n:function(){return i}});const i=t=>!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType},6736:function(t,e,n){n.d(e,{f:function(){return o}});var i=n(61701),s=n(72621),a=(n(19083),n(71695),n(40251),n(61006),n(39527),n(36993),n(47021),n(50778));const o=t=>(0,i.Z)(null,(function(t,e){class n extends e{constructor(...e){super(...e),t(this)}}return{F:n,d:[{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,s.Z)(n,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,s.Z)(n,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const t=this.__unsubs.pop();t instanceof Promise?t.then((t=>t())):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,s.Z)(n,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const e of t.keys())if(this.hassSubscribeRequiredHostProps.includes(e))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){var t;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((t=>void 0===this[t]))||(this.__unsubs=this.hassSubscribe())}}]}}),t)},18709:function(t,e,n){n.a(t,(async function(t,i){try{n.r(e),n.d(e,{HuiEnergyDevicesGraphCard:function(){return S}});var s=n(61701),a=(n(71695),n(92745),n(61893),n(40251),n(39527),n(67670),n(41360),n(47021),n(28451)),o=n(57243),r=n(50778),c=n(35359),u=n(27486),d=n(50875),h=n(36522),l=n(50602),f=(n(29937),n(54977),n(1118)),v=n(17705),b=n(6736),k=n(93331),p=n(18520),_=t([f,l,a]);[f,l,a]=_.then?(await _)():_;let g,y,m,C=t=>t,S=(0,s.Z)([(0,r.Mo)("hui-energy-devices-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_chartData",value(){return{datasets:[]}}},{kind:"field",decorators:[(0,r.SB)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,r.IO)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t;return[(0,f.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((t=>{this._data=t,this._getStatistics(t)}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,k.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){var t;return this.hass&&this._config?(0,o.dy)(g||(g=C` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" chart-type="bar"></ha-chart-base> </div> </ha-card> `),this._config.title?(0,o.dy)(y||(y=C`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,c.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this.hass.locale),28*((null===(t=this._chartData)||void 0===t||null===(t=t.datasets[0])||void 0===t?void 0:t.data.length)||0)+50):o.Ld}},{kind:"field",key:"_createOptions",value(){return(0,u.Z)((t=>({parsing:!1,responsive:!0,maintainAspectRatio:!1,indexAxis:"y",scales:{y:{type:"category",ticks:{autoSkip:!1,callback:t=>{const e=this._chartData.datasets[0].data[t].y;return this._getDeviceName(e)}}},x:{title:{display:!0,text:"kWh"}}},elements:{bar:{borderWidth:1,borderRadius:4}},plugins:{tooltip:{mode:"nearest",callbacks:{title:t=>{const e=t[0].label;return this._getDeviceName(e)},label:e=>`${e.dataset.label}: ${(0,l.uf)(e.parsed.x,t)} kWh`}}},locale:(0,l.Hd)(this.hass.locale),onClick:t=>{var e;if((0,p.n)(t))return;const n=t.chart,i=(0,a.z)(t,n),s=Math.abs(n.scales.y.getValueForPixel(i.y)),o=null===(e=this._chartData)||void 0===e||null===(e=e.datasets[0])||void 0===e||null===(e=e.data[s])||void 0===e?void 0:e.y;o&&!(0,v.Hs)(o)&&((0,h.B)(this,"hass-more-info",{entityId:o}),n.canvas.dispatchEvent(new Event("mouseout")))}})))}},{kind:"method",key:"_getDeviceName",value:function(t){var e,n;return(null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find((e=>e.stat_consumption===t)))||void 0===e?void 0:e.name)||(0,v.Kd)(this.hass,t,null===(n=this._data)||void 0===n?void 0:n.statsMetadata[t])}},{kind:"method",key:"_getStatistics",value:async function(t){var e,n;const i=t.stats,s=t.statsCompare,a=[],o=[],r=[],c=[],u=[],h=[],l=[{label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),borderColor:r,backgroundColor:u,data:a,barThickness:s?10:20}];s&&l.push({label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),borderColor:c,backgroundColor:h,data:o,barThickness:10}),t.prefs.device_consumption.forEach(((t,e)=>{const n=t.stat_consumption in i&&(0,v.Kj)(i[t.stat_consumption])||0;if(a.push({y:t.stat_consumption,x:n,idx:e}),s){const n=t.stat_consumption in s&&(0,v.Kj)(s[t.stat_consumption])||0;o.push({y:t.stat_consumption,x:n,idx:e})}})),a.sort(((t,e)=>e.x-t.x)),a.length=(null===(e=this._config)||void 0===e?void 0:e.max_devices)||a.length;const f=getComputedStyle(this);a.forEach((t=>{const e=(0,d.hZ)(t.idx,f);r.push(e),u.push(e+"7F")})),o.forEach((t=>{const e=(0,d.hZ)(t.idx,f);c.push(e+"7F"),h.push(e+"32")})),this._chartData={labels:a.map((t=>t.y)),datasets:l},await this.updateComplete,null===(n=this._chart)||void 0===n||n.updateChart("none")}},{kind:"get",static:!0,key:"styles",value:function(){return(0,o.iv)(m||(m=C`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}`))}}]}}),(0,b.f)(o.oi));i()}catch(g){i(g)}}))},32424:function(t,e,n){n.d(e,{E:function(){return a}});var i=n(53907),s=n(18112);function a(t,e,n){const a=(0,s.Q)(t,null==n?void 0:n.in);return isNaN(e)?(0,i.L)((null==n?void 0:n.in)||t,NaN):e?(a.setDate(a.getDate()+e),a):a}},38836:function(t,e,n){n.d(e,{T:function(){return a}});var i=n(23711),s=n(76808);function a(t,e,n){return(0,i.n)(t,e*s.vh,n)}},23711:function(t,e,n){n.d(e,{n:function(){return a}});var i=n(53907),s=n(18112);function a(t,e,n){return(0,i.L)((null==n?void 0:n.in)||t,+(0,s.Q)(t)+e)}},23459:function(t,e,n){n.d(e,{z:function(){return a}});var i=n(53907),s=n(18112);function a(t,e,n){const a=(0,s.Q)(t,null==n?void 0:n.in);if(isNaN(e))return(0,i.L)((null==n?void 0:n.in)||t,NaN);if(!e)return a;const o=a.getDate(),r=(0,i.L)((null==n?void 0:n.in)||t,a.getTime());r.setMonth(a.getMonth()+e+1,0);return o>=r.getDate()?r:(a.setFullYear(r.getFullYear(),r.getMonth(),o),a)}},2425:function(t,e,n){n.d(e,{U:function(){return s}});var i=n(18112);function s(t,e){const n=+(0,i.Q)(t)-+(0,i.Q)(e);return n<0?-1:n>0?1:n}},14276:function(t,e,n){n.d(e,{_:function(){return s}});var i=n(18112);function s(t,e){return+(0,i.Q)(t)-+(0,i.Q)(e)}},6542:function(t,e,n){n.d(e,{d:()=>r});n("71695"),n("47021");var i=n("18492"),s=n("2425");function a(t,e,n){const[s,a]=(0,i.d)(null==n?void 0:n.in,t,e);return 12*(s.getFullYear()-a.getFullYear())+(s.getMonth()-a.getMonth())}var o=n("3938");function r(t,e,n){const[r,c,u]=(0,i.d)(null==n?void 0:n.in,t,t,e),d=(0,s.U)(c,u),h=Math.abs(a(c,u));if(h<1)return 0;1===c.getMonth()&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-d*h);let l=(0,s.U)(c,u)===-d;(0,o.h)(r)&&1===h&&1===(0,s.U)(r,u)&&(l=!1);const f=d*(h-+l);return 0===f?0:f}},96500:function(t,e,n){n.d(e,{i:function(){return s}});var i=n(18112);function s(t,e){const n=(0,i.Q)(t,null==e?void 0:e.in);return n.setHours(23,59,59,999),n}},2621:function(t,e,n){n.d(e,{V:function(){return s}});var i=n(18112);function s(t,e){const n=(0,i.Q)(t,null==e?void 0:e.in),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}},86319:function(t,e,n){n.d(e,{b:function(){return s}});var i=n(18112);function s(t,e){return 1===(0,i.Q)(t,null==e?void 0:e.in).getDate()}},3938:function(t,e,n){n.d(e,{h:function(){return o}});var i=n(96500),s=n(2621),a=n(18112);function o(t,e){const n=(0,a.Q)(t,null==e?void 0:e.in);return+(0,i.i)(n,e)==+(0,s.V)(n,e)}}}]);
//# sourceMappingURL=34321.02769d8a062c85e0.js.map