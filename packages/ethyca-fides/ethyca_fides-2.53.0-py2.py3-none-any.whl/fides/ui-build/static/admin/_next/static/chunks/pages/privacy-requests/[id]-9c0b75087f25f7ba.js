(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9650],{6554:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/[id]",function(){return n(6742)}])},43124:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var i=n(24246),r=n(5702),s=n(88038),l=n.n(s),o=n(86677);n(27378);var a=n(11596),c=n(72247),d=n(11032),u=()=>{let e=(0,o.useRouter)();return(0,i.jsx)(r.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(r.xuv,{children:[(0,i.jsxs)(r.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(r.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(r.wpx,{onClick:()=>{e.push(d.fz)},children:"Configure"})]}),(0,i.jsxs)(r.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},h=e=>{let{children:t,title:n,padded:s=!0,mainProps:d}=e,h=(0,a.hz)(),x=(0,o.useRouter)(),g="/privacy-requests"===x.pathname||"/datastore-connection"===x.pathname,m=!(h.flags.privacyRequestsConfiguration&&g),{data:f}=(0,c.JE)(void 0,{skip:m}),{data:j}=(0,c.PW)(void 0,{skip:m}),p=h.flags.privacyRequestsConfiguration&&(!f||!j)&&g;return(0,i.jsxs)(r.kCb,{"data-testid":n,direction:"column",h:"100vh",children:[(0,i.jsxs)(l(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(r.kCb,{as:"main",direction:"column",py:s?6:0,px:s?10:0,h:s?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...d,children:[p?(0,i.jsx)(u,{}):null,t]})]})}},60136:function(e,t,n){"use strict";n.d(t,{D4:function(){return s.D4},MM:function(){return h},Ot:function(){return c},c6:function(){return r},cj:function(){return g},e$:function(){return o},fn:function(){return a},iC:function(){return x},nU:function(){return u},tB:function(){return d}});var i,r,s=n(41164);let l="An unexpected error occurred. Please try again.",o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if((0,s.Bw)(e)){if((0,s.hE)(e.data))return e.data.detail;if((0,s.cz)(e.data)){var n;let t=null===(n=e.data.detail)||void 0===n?void 0:n[0];return"".concat(null==t?void 0:t.msg,": ").concat(null==t?void 0:t.loc)}if(409===e.status&&(0,s.Dy)(e.data)||404===e.status&&(0,s.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return t};function a(e){return"object"==typeof e&&null!=e&&"status"in e}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function d(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:l};if((0,s.oK)(e))return{status:e.originalStatus,message:e.data};if((0,s.Bw)(e)){let{status:n}=e;return{status:n,message:o(e,t.message)}}return t},h=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(i=r||(r={})).GVL="gvl",i.AC="gacp",i.COMPASS="compass";let x={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},g=e=>{let t=e.split(".")[0];return"gacp"===t?"gacp":"gvl"===t?"gvl":"compass"}},41628:function(e,t,n){"use strict";var i=n(24246),r=n(5702),s=n(27378),l=n(44296),o=n(60136),a=n(53359),c=n(72247);let d=(0,r.Gpc)((e,t)=>{let{handleBlur:n,subjectRequest:d}=e,u=(0,l.T)(),[h,x]=(0,s.useState)(!1),{errorAlert:g,successAlert:m}=(0,a.V)(),{errorRequests:f}=(0,l.C)(c.fe),[j]=(0,c.JD)(),[p]=(0,c.Fq)(),v=async()=>{x(!0);let e=await j(f);"error"in e?(u((0,c.uT)({checkAll:!1,errorRequests:[]})),g((0,o.e$)(e.error),"DSR batch automation has failed due to the following:",{duration:null})):(e.data.failed.length>0&&g((0,i.jsxs)(r.xuv,{children:["DSR automation has failed for"," ",(0,i.jsx)(r.xvT,{as:"span",fontWeight:"semibold",children:e.data.failed.length})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null}),e.data.succeeded.length>0&&m("Privacy request(s) are now being reprocessed.")),x(!1)},y=async()=>{if(!d)return;x(!0);let e=await p(d);"error"in e?g((0,o.e$)(e.error),"DSR automation has failed for this privacy request due to the following:",{duration:null}):m("Privacy request is now being reprocessed."),x(!1),n&&n(t)};return(0,i.jsx)(r.wpx,{disabled:h,loading:h,onClick:d?y:v,ref:t,size:"small",icon:(0,i.jsx)(r.AyE,{}),children:"Reprocess"})});t.Z=d},6742:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return et}});var i,r,s=n(24246),l=n(5702),o=n(86677),a=n(43124),c=n(11032),d=n(37541),u=n(27365),h=n(27378),x=n(10284),g=n(71288),m=e=>{let{errorMessage:t}=e;return(0,s.jsxs)(l.xuv,{height:"100%",id:"outer",children:[(0,s.jsxs)(l.kCb,{alignItems:"center",paddingBottom:"8px",children:[(0,s.jsx)(l.xvT,{size:"sm",color:"gray.700",fontWeight:"medium",marginRight:"8px",lineHeight:"20px",children:"Status"}),(0,s.jsx)(l.Vp9,{size:"sm",height:"20px",backgroundColor:"red.500",color:"white",marginRight:"8px",children:"Error"}),(0,s.jsx)(l.xuv,{padding:"0px",marginBottom:"3px",children:(0,s.jsx)(g.Z,{copyText:t})})]}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xuv,{id:"errorWrapper",overflow:"auto",height:"100%",children:(0,s.jsx)(l.xvT,{children:t})})]})},f=n(21820);(i=r||(r={})).IN_PROCESSING="in_processing",i.PENDING="pending",i.COMPLETE="complete",i.ERROR="error",i.PAUSED="paused",i.RETRYING="retrying",i.SKIPPED="skipped";let j=e=>{switch(e){case x.Us.ACCESS:return"Data Retrieval";case x.Us.ERASURE:return"Data Deletion";case x.Us.CONSENT:return"Consent";case x.Us.UPDATE:return"Data Update";default:return e}};var p=e=>{let{eventLogs:t,openErrorPanel:n}=e,i=null==t?void 0:t.map(e=>(0,s.jsxs)(l.Tr,{_hover:{backgroundColor:e.status===r.ERROR?"#F7FAFC":"unset"},onClick:()=>{e.status===r.ERROR&&n(e.message)},style:{cursor:e.status===r.ERROR?"pointer":"unset"},children:[(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:(0,f.p6)(e.updated_at)})}),(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:j(e.action_type)})}),(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:e.status})}),(0,s.jsx)(l.Td,{children:(0,s.jsx)(l.xvT,{color:"gray.600",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:e.collection_name})})]},e.updated_at));return(0,s.jsx)(l.xuv,{width:"100%",paddingTop:"0px",height:"100%",children:(0,s.jsx)(l.xJi,{id:"tableContainer",height:"100%",style:{overflowY:"auto"},children:(0,s.jsxs)(l.iA_,{size:"sm",id:"table",position:"relative",children:[(0,s.jsx)(l.hrZ,{id:"tableHeader",position:"sticky",top:"0px",backgroundColor:"white",children:(0,s.jsxs)(l.Tr,{children:[(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Time"})}),(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Action Type"})}),(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Status"})}),(0,s.jsx)(l.Th,{children:(0,s.jsx)(l.xvT,{color:"black",fontSize:"xs",lineHeight:"4",fontWeight:"medium",children:"Collection"})})]})}),(0,s.jsx)(l.p3B,{id:"tableBody",children:i})]})})})},v=e=>{let{isOpen:t,onClose:n,currentLogs:i,isViewingError:r,errorMessage:o,onCloseErrorPanel:a,onOpenErrorPanel:c}=e;return(0,s.jsxs)(l.dys,{isOpen:t,placement:"right",onClose:n,size:"full",autoFocus:!1,children:[(0,s.jsx)(l.P1B,{}),(0,s.jsxs)(l.scA,{style:{width:"50%"},children:[(0,s.jsx)(l.OXI,{style:{paddingBottom:"0px"},children:(0,s.jsxs)(l.kCb,{justifyContent:"space-between",alignItems:"center",height:"40px",children:[(0,s.jsxs)(l.kCb,{alignItems:"center",children:[r&&(0,s.jsx)(l.wpx,{icon:(0,s.jsx)(l.Rpv,{}),"aria-label":"Close error logs",size:"small",onClick:a}),(0,s.jsx)(l.xvT,{color:"gray.900",fontSize:"md",lineHeight:"6",fontWeight:"medium",ml:1,children:r?"Event detail":"Event log"})]}),(0,s.jsx)(l.wpx,{icon:(0,s.jsx)(l.LGN,{width:"17px"}),"aria-label":"Stop viewing error message",size:"small",onClick:n})]})}),(0,s.jsxs)(l.Ng0,{id:"drawerBody",overflow:"hidden",children:[i&&!r?(0,s.jsx)(p,{eventLogs:i,openErrorPanel:c}):null,r?(0,s.jsx)(m,{errorMessage:o}):null]})]})]})};let y=e=>{if(0===e.length)return!1;let t=Array.from(e).sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());if(!t[0].collection_name)return t[0].status===r.ERROR;let n={};return t.forEach(e=>{e.collection_name&&!n[e.collection_name]&&(n[e.collection_name]=e)}),Object.values(n).some(e=>e.status===r.ERROR)};var b=e=>{let{entryKey:t,logs:n,isLast:i,onViewLog:r}=e;return(0,s.jsxs)(l.xuv,{children:[(0,s.jsxs)(l.kCb,{alignItems:"center",height:23,position:"relative",children:[(0,s.jsx)(l.xuv,{zIndex:1,children:y(n)?(0,s.jsx)(l.f9v,{}):(0,s.jsx)(l.StI,{})}),!i&&(0,s.jsx)(l.xuv,{width:"2px",height:"63px",backgroundColor:"gray.700",position:"absolute",top:"16px",left:"6px",zIndex:0}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",ml:2,children:t})]}),(0,s.jsx)(l.xvT,{cursor:"pointer",color:"complimentary.500",fontWeight:"500",fontSize:"sm",ml:6,mb:7,onClick:()=>r(),children:"View log"})]})},C=e=>{let{subjectRequest:t}=e,{isOpen:n,onOpen:i,onClose:r}=(0,l.qY0)(),[o,a]=(0,h.useState)([]),[c,d]=(0,h.useState)(""),[u,x]=(0,h.useState)(!1),[g,m]=(0,h.useState)(""),{results:f}=t,j=f?Object.keys(f):[];(0,h.useEffect)(()=>{c&&f&&f[c]&&a(f[c])},[f,c]);let p=()=>{x(!1)},y=(e,t)=>{d(e),a(t),i()};return(0,s.jsxs)(l.xuv,{width:"100%",children:[(0,s.jsx)(l.xvT,{color:"gray.900",fontSize:"md",fontWeight:"500",mb:1,children:"Activity timeline"}),f&&j.map((e,t)=>(0,s.jsx)(b,{entryKey:e,logs:f[e],isLast:t===j.length-1,onViewLog:()=>y(e,f[e])},e)),(0,s.jsx)(v,{isOpen:n,onClose:()=>{u&&p(),d(""),r()},currentLogs:o,isViewingError:u,errorMessage:g,onOpenErrorPanel:e=>{m(e),x(!0)},onCloseErrorPanel:p})]})},S=e=>{let{subjectRequest:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mb:4,children:"Events and logs"}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.kCb,{mt:3,children:(0,s.jsx)(C,{subjectRequest:t})})]})},w=n(53359),k=n(7564),_=n(72247),R=n(44296);let T=e=>Array.from(new Set(e.filter(e=>Object.values(x.Us).includes(e.action_type)).map(e=>e.action_type)));var z=e=>{let{rules:t}=e,n=T(t).map(e=>(0,f.kC)(e)).map(e=>(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:e},e));return(0,s.jsx)(l.xuv,{children:n})},E=n(34090),q=n(59389),A=e=>{let{connectorName:t,data:n,isSubmitting:i=!1,onSaveClick:r}=e,{isOpen:o,onOpen:a,onClose:c}=(0,l.qY0)(),d=(0,h.useRef)(null),u=async(e,t)=>{r({connection_key:n.connection_key,privacy_request_id:n.privacy_request_id,body:{...e}}),c()};return(0,s.jsxs)(s.Fragment,{children:[(null==n?void 0:n.checked)&&(0,s.jsx)(l.wpx,{onClick:a,size:"small",children:"Review"}),!(null==n?void 0:n.checked)&&(0,s.jsx)(l.wpx,{onClick:a,size:"small",type:"primary",children:"Begin manual input"}),(0,s.jsx)(E.J9,{enableReinitialize:!0,initialValues:{...n.fields},onSubmit:u,validateOnBlur:!1,validateOnChange:!1,validationSchema:q.Ry().shape({}),children:e=>(0,s.jsxs)(l.dys,{isOpen:o,placement:"right",initialFocusRef:d,onClose:c,size:"lg",children:[(0,s.jsx)(l.P1B,{}),(0,s.jsxs)(l.scA,{children:[(0,s.jsx)(l.cCv,{}),(0,s.jsxs)(l.OXI,{color:"gray.900",children:[(0,s.jsx)(l.xvT,{fontSize:"xl",mb:8,children:t}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xvT,{fontSize:"md",mt:"4",children:"Manual access"}),(0,s.jsx)(l.xuv,{mt:"8px",children:(0,s.jsx)(l.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"normal",children:"Please complete the following PII fields that have been collected for the selected subject."})})]}),(0,s.jsx)(l.Ng0,{children:(0,s.jsx)(E.l0,{id:"manual-detail-form",noValidate:!0,children:(0,s.jsx)(l.gCW,{align:"stretch",gap:"16px",children:Object.entries(n.fields).map((e,t)=>{let[n]=e;return(0,s.jsx)(l.Ugi,{children:(0,s.jsx)(E.gN,{id:n,name:n,children:e=>{let{field:i}=e;return(0,s.jsxs)(l.NIc,{alignItems:"baseline",display:"inline-flex",children:[(0,s.jsx)(l.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:n,w:"50%",children:n}),(0,s.jsx)(l.IIB,{...i,autoComplete:"off",color:"gray.700",placeholder:"Please enter ".concat(n),ref:0===t?d:void 0,size:"sm"})]})}})},n)})})})}),(0,s.jsx)(l.zeN,{justifyContent:"flex-start",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.wpx,{onClick:c,children:"Cancel"}),(0,s.jsx)(l.wpx,{form:"manual-detail-form",loading:i,htmlType:"submit",children:"Save"})]})})]})]})})]})},I=e=>{let{connectorName:t,data:n,isSubmitting:i=!1,onSaveClick:r}=e,{isOpen:o,onOpen:a,onClose:c}=(0,l.qY0)(),d=(0,h.useRef)(null),u=async(e,t)=>{r({connection_key:n.connection_key,privacy_request_id:n.privacy_request_id,body:{...e}}),c()};return(0,s.jsxs)(s.Fragment,{children:[(null==n?void 0:n.checked)&&(0,s.jsx)(l.wpx,{onClick:a,size:"small",children:"Review"}),!(null==n?void 0:n.checked)&&(0,s.jsx)(l.wpx,{onClick:a,size:"small",type:"primary",children:"Begin manual input"}),(0,s.jsx)(E.J9,{enableReinitialize:!0,initialValues:{...n.fields},onSubmit:u,validateOnBlur:!1,validateOnChange:!1,validationSchema:q.Ry().shape({}),children:e=>(0,s.jsxs)(l.dys,{isOpen:o,placement:"right",initialFocusRef:d,onClose:c,size:"lg",children:[(0,s.jsx)(l.P1B,{}),(0,s.jsxs)(l.scA,{children:[(0,s.jsx)(l.cCv,{}),(0,s.jsxs)(l.OXI,{color:"gray.900",children:[(0,s.jsx)(l.xvT,{fontSize:"xl",mb:8,children:t}),(0,s.jsx)(l.izJ,{}),(0,s.jsx)(l.xvT,{fontSize:"md",mt:"4",children:"Manual erasure"}),(0,s.jsx)(l.xuv,{mt:"8px",children:(0,s.jsx)(l.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"normal",children:"Please delete the following PII fields associated with the selected subject if they are available. Once deleted, check the box to confirm the deletion."})})]}),(0,s.jsx)(l.Ng0,{children:(0,s.jsx)(E.l0,{id:"manual-detail-form",noValidate:!0,children:(0,s.jsx)(l.gCW,{align:"stretch",gap:"16px",children:Object.entries(n.fields).map(e=>{let[t]=e;return(0,s.jsx)(l.Ugi,{children:(0,s.jsx)(E.gN,{id:t,name:t,children:e=>{let{field:n}=e;return(0,s.jsxs)(l.NIc,{alignItems:"baseline",display:"inline-flex",children:[(0,s.jsx)(l.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:t,w:"50%",children:t}),(0,s.jsx)(l.XZJ,{...n,isChecked:!!n.value,onChange:n.onChange,name:t,id:t})]})}})},t)})})})}),(0,s.jsx)(l.zeN,{justifyContent:"flex-start",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.wpx,{onClick:c,children:"Cancel"}),(0,s.jsx)(l.wpx,{form:"manual-detail-form",loading:i,htmlType:"submit",children:"Save"})]})})]})]})})]})};let W=(e,t,n)=>e.includes(x.Us.ACCESS)?{ProcessingDetailComponent:A,uploadMutation:t,getUploadedWebhookDataEndpoint:_.$I.endpoints.getUploadedManualAccessWebhookData}:e.includes(x.Us.ERASURE)?{ProcessingDetailComponent:I,uploadMutation:n,getUploadedWebhookDataEndpoint:_.$I.endpoints.getUploadedManualErasureWebhookData}:null;var O=e=>{let{subjectRequest:t}=e,n=(0,R.T)(),{errorAlert:i,successAlert:r}=(0,w.V)(),{handleError:o}=(0,w.H)(),[a,c]=(0,h.useState)([]),[d,u]=(0,h.useState)(!1),[g,m]=(0,h.useState)(!1),{data:f,isFetching:j,isLoading:p,isSuccess:v}=(0,k.W6)(),[y]=(0,_.w3)(),b=T(t.policy.rules),[C]=(0,_.nL)(),[S]=(0,_.UR)(),{ProcessingDetailComponent:z,uploadMutation:E,getUploadedWebhookDataEndpoint:q}=W(b,C,S),A=async()=>{try{u(!0),await y(t.id).unwrap(),r("Manual request has been received. Request now processing.")}catch(e){o(e)}finally{u(!1)}},I=async e=>{try{m(!0),await E(e).unwrap();let t={connection_key:e.connection_key,fields:{}};Object.entries(e.body).forEach(e=>{let[n,i]=e;t.fields[n]=i||""});let n=a.map(e=>e.connection_key===t.connection_key?{...e,checked:!0,fields:{...t.fields}}:e);c(n),r("Manual input successfully saved!")}catch(e){o(e)}finally{m(!1)}};return((0,h.useEffect)(()=>(v&&f.length>0&&0===a.length&&(()=>{if(a.length>0)return;let e=[],r=null==f?void 0:f.map(e=>e.connection_config.key);null==r||r.every(i=>e.push(n(q.initiate({connection_key:i,privacy_request_id:t.id})))),Promise.allSettled(e).then(e=>{let t=[];e.forEach((e,n)=>{if("fulfilled"===e.status&&e.value.isSuccess&&e.value.data){let n={checked:e.value.data.checked,fields:{},connection_key:e.value.originalArgs.connection_key,privacy_request_id:e.value.originalArgs.privacy_request_id};Object.entries(e.value.data.fields).forEach(e=>{let[t,i]=e;n.fields[t]=i||""}),t.push(n)}else i("An error occurred while loading manual input data for ".concat(f[n].connection_config.name))}),c(t)})})(),()=>{}),[f,a.length,n,i,v,t.id,q]),b.includes(x.Us.ACCESS)||b.includes(x.Us.ERASURE))?(0,s.jsxs)(l.gCW,{align:"stretch",spacing:8,children:[(0,s.jsxs)(l.xuv,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mb:4,children:"Manual Processing"}),(0,s.jsx)(l.izJ,{})]}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(l.xvT,{color:"gray.700",fontSize:"sm",children:"The following table details the integrations that require manual input from you."})}),(0,s.jsxs)(l.xuv,{children:[(j||p)&&(0,s.jsx)(l.M5Y,{children:(0,s.jsx)(l.$jN,{})}),v&&f?(0,s.jsx)(l.xJi,{children:(0,s.jsxs)(l.iA_,{size:"sm",variant:"unstyled",children:[(0,s.jsx)(l.hrZ,{children:(0,s.jsxs)(l.Tr,{children:[(0,s.jsx)(l.Th,{fontSize:"sm",fontWeight:"semibold",pl:"0",textTransform:"none",children:"Integration Identifier"}),(0,s.jsx)(l.Th,{})]})}),(0,s.jsxs)(l.p3B,{children:[f.length>0&&f.map(e=>(0,s.jsxs)(l.Tr,{display:"block",children:[(0,s.jsx)(l.Td,{pl:"0",children:e.connection_config.key}),(0,s.jsx)(l.Td,{children:a.length>0?(0,s.jsx)(z,{connectorName:e.connection_config.name,data:a.find(t=>t.connection_key===e.connection_config.key),isSubmitting:g,onSaveClick:I}):null})]},e.id)),0===f.length&&(0,s.jsx)(l.Tr,{children:(0,s.jsx)(l.Td,{colSpan:3,pl:"0",children:(0,s.jsx)(l.M5Y,{children:(0,s.jsx)(l.xvT,{children:"You don‘t have any Manual Process connections set up yet."})})})})]}),a.length>0&&a.every(e=>e.checked)?(0,s.jsx)(l.$RU,{children:(0,s.jsx)(l.Tr,{children:(0,s.jsx)(l.Th,{pl:"0px",children:(0,s.jsx)(l.wpx,{size:"small",type:"primary",loading:d,onClick:A,children:"Complete DSR"})})})}):null]})}):null]})]}):null},P=n(93261),N=e=>{let{daysLeft:t,includeText:n,status:i}=e;if(!t||i===P.q.COMPLETE||i===P.q.CANCELED||i===P.q.DENIED||i===P.q.IDENTITY_UNVERIFIED)return null;let r="";switch(!0){case t>=10:r="green.500";break;case t<10&&t>4:r="orange.500";break;case t<5:r="red.400"}return(0,s.jsx)(l.Vp9,{backgroundColor:r,color:"white",fontWeight:"medium",fontSize:"sm",children:n?"".concat(t," days left"):t})},D=n(11596);let U={approved:{bg:"yellow.500",label:"Approved"},complete:{bg:"green.500",label:"Completed"},awaiting_email_send:{bg:"gray.400",label:"Awaiting Email Send"},denied:{bg:"red.500",label:"Denied"},canceled:{bg:"red.600",label:"Canceled"},error:{bg:"red.800",label:"Error"},in_processing:{bg:"orange.500",label:"In Progress"},paused:{bg:"gray.400",label:"Paused"},pending:{bg:"blue.400",label:"New"},identity_unverified:{bg:"red.400",label:"Unverified"},requires_input:{bg:"yellow.400",label:"Requires Input"}};var L=e=>{let{status:t}=e;return(0,s.jsx)(l.Cts,{color:"white",bg:U[t].bg,width:"100%",minWidth:"120px",lineHeight:"18px",textAlign:"center","data-testid":"request-status-badge",children:(0,s.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[U[t].label,t===x.q2.IN_PROCESSING&&(0,s.jsx)(l.$jN,{size:"xs",color:"white",ml:2})]})})},F=n(60136),M=n(62528),V=n(38615),B=e=>{var t;let{requestId:n}=e,{data:i,isLoading:r,isError:o,error:a}=(0,_.br)({privacy_request_id:n}),c=o?(0,F.e$)(a,"Unable to resolve download URL"):"Requests stored locally cannot be downloaded",d=null!==(t=null==i?void 0:i.access_result_urls[0])&&void 0!==t?t:"",u=!!d&&"your local fides_uploads folder"!==d;return(0,s.jsx)(V.ZP,{scopes:[x.Sh.PRIVACY_REQUEST_ACCESS_RESULTS_READ],children:(0,s.jsx)(l.kCb,{children:(0,s.jsx)(l.ua7,{isDisabled:u,label:c,children:(0,s.jsx)(l.wpx,{onClick:()=>{let e=document.createElement("a");e.href=d,e.target="_blank",e.rel="noopener noreferrer",e.click(),e.remove()},icon:(0,s.jsx)(M.nM,{}),loading:r,disabled:!u,"data-testid":"download-results-btn",children:"Download request results"})})})})},J=n(21613),G=n(25662);let X=(0,l.Gpc)((e,t)=>(0,s.jsx)(l.wpx,{ref:t,size:"small",...e})),Z=(0,l.Gpc)((e,t)=>{let{buttonProps:n,children:i,onClose:r,subjectRequest:o}=e,{handleApproveRequest:a,isLoading:c}=(0,G.Z)({subjectRequest:o}),d=(0,l.qY0)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X,{ref:t,onClick:d.onOpen,isLoading:c,isDisabled:c,...n,"data-testid":"privacy-request-approve-btn",children:i}),(0,s.jsx)(J.Z,{isOpen:d.isOpen,isLoading:c,onClose:()=>{d.onClose(),null==r||r()},onApproveRequest:a,subjectRequest:o})]})});var H=n(94723);let Y=(0,l.Gpc)((e,t)=>{let{buttonProps:n,children:i,onClose:r,subjectRequest:o}=e,{handleDenyRequest:a,isLoading:c}=(0,G.Z)({subjectRequest:o}),d=(0,l.qY0)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X,{ref:t,onClick:d.onOpen,isLoading:c,isDisabled:c,...n,"data-testid":"privacy-request-deny-btn",children:i}),(0,s.jsx)(H.Z,{isOpen:d.isOpen,onClose:()=>{d.onClose(),null==r||r()},onDenyRequest:a})]})});var $=n(41628),K=e=>{let{subjectRequest:t}=e,{plus:n}=(0,D.hz)(),{id:i,status:r,policy:o}=t,{flags:{downloadAccessRequestResults:a}}=(0,D.hz)(),c=a&&T(o.rules).includes(x.Us.ACCESS)&&r===P.q.COMPLETE;return(0,s.jsxs)(l.kCb,{direction:"column",gap:4,children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mt:4,mb:4,children:"Request details"}),(0,s.jsx)(l.izJ,{}),(0,s.jsxs)(l.kCb,{alignItems:"center",children:[(0,s.jsx)(l.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Request ID:"}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:1,children:i}),(0,s.jsx)(g.Z,{copyText:i,size:"small"})]}),n&&t.source&&(0,s.jsxs)(l.kCb,{children:[(0,s.jsx)(l.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Source:"}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:t.source})})]}),(0,s.jsxs)(l.kCb,{alignItems:"center",children:[(0,s.jsx)(l.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Request type:"}),(0,s.jsx)(l.xuv,{mr:1,children:(0,s.jsx)(z,{rules:o.rules})})]}),(0,s.jsxs)(l.kCb,{children:[(0,s.jsx)(l.xvT,{mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Policy key:"}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:t.policy.key})})]}),(0,s.jsxs)(l.kCb,{alignItems:"center",children:[(0,s.jsx)(l.xvT,{mb:0,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:"Status:"}),(0,s.jsxs)(l.Ugi,{spacing:"8px",children:[(0,s.jsx)(l.kCb,{children:(0,s.jsx)(L,{status:r})}),(0,s.jsxs)("div",{className:"flex gap-3",children:["error"===r&&(0,s.jsx)($.Z,{subjectRequest:t}),"pending"===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z,{subjectRequest:t,children:"Approve"}),(0,s.jsx)(Y,{subjectRequest:t,children:"Deny"})]})]}),(0,s.jsx)(N,{daysLeft:t.days_left,includeText:!0,status:t.status})]})]}),c&&(0,s.jsx)(B,{requestId:i})]})},Q=e=>{let{subjectRequest:t}=e,{identity:n,identity_verified_at:i,custom_privacy_request_fields:r}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.kCb,{direction:"row",justifyContent:"space-between",children:(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mb:4,mt:4,children:"Subject identities"})}),(0,s.jsx)(l.izJ,{mb:4}),Object.entries(n).filter(e=>{let[,{value:t}]=e;return null!==t}).map(e=>{let[t,{value:n,label:r}]=e;return(0,s.jsxs)(l.kCb,{alignItems:"flex-start",children:[(0,s.jsxs)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[r,":"]}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:n||""}),(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:i?"Verified":"Unverified"})]},t)}),r&&Object.keys(r).length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.X6q,{color:"gray.900",fontSize:"lg",fontWeight:"semibold",mt:4,mb:4,children:"Custom request fields"}),(0,s.jsx)(l.izJ,{mb:4}),Object.entries(r).filter(e=>{let[,t]=e;return t.value}).map(e=>{let[t,n]=e;return(0,s.jsxs)(l.kCb,{alignItems:"flex-start",children:[(0,s.jsxs)(l.xvT,{mb:4,mr:2,fontSize:"sm",color:"gray.900",fontWeight:"500",children:[n.label,":"]}),(0,s.jsx)(l.xvT,{color:"gray.600",fontWeight:"500",fontSize:"sm",mr:2,children:Array.isArray(n.value)?n.value.join(", "):n.value}),(0,s.jsx)(l.Vp9,{color:"white",bg:"primary.400",fontWeight:"medium",fontSize:"sm",children:"Unverified"})]},t)})]})]})},ee=e=>{var t;let{data:n}=e,i=(0,h.useMemo)(()=>({id:n.id,verbose:!0}),[n.id]),{data:r}=(0,u.QA)(i,{pollingInterval:n.status===x.q2.APPROVED||n.status===x.q2.IN_PROCESSING?2e3:0,skip:!n.id}),o=null!==(t=null==r?void 0:r.items[0])&&void 0!==t?t:n;return(0,s.jsxs)(l.gCW,{align:"stretch",display:"flex-start",spacing:6,children:[(0,s.jsx)(l.xuv,{"data-testid":"privacy-request-details",children:(0,s.jsx)(K,{subjectRequest:o})}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(Q,{subjectRequest:o})}),o.status===x.q2.REQUIRES_INPUT&&(0,s.jsx)(l.xuv,{children:(0,s.jsx)(O,{subjectRequest:o})}),(0,s.jsx)(l.xuv,{children:(0,s.jsx)(S,{subjectRequest:o})})]})},et=()=>{let e;let{id:t=""}=(0,o.useRouter)().query,{data:n,isLoading:i,isUninitialized:r}=(0,u.QA)({id:Array.isArray(t)?t[0]:t,verbose:!0},{skip:""===t});return e=r||i?(0,s.jsx)(l.M5Y,{children:(0,s.jsx)(l.$jN,{})}):n&&(null==n?void 0:n.items.length)!==0?(0,s.jsx)(ee,{data:null==n?void 0:n.items[0]}):(0,s.jsx)(l.xvT,{children:"404 no privacy request found"}),(0,s.jsxs)(a.Z,{title:"Privacy Request - ".concat(t),children:[(0,s.jsx)(d.Z,{heading:"Privacy Requests",breadcrumbItems:[{title:"All requests",href:c.Jw},{title:"Request details"}]}),e]})}},41164:function(e,t,n){"use strict";n.d(t,{Bw:function(){return l},D4:function(){return r},Dy:function(){return a},XD:function(){return c},cz:function(){return d},hE:function(){return o},oK:function(){return s}});var i=n(76649);let r=e=>"error"in e,s=e=>(0,i.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,l=e=>(0,i.Ln)({status:"number",data:{}},e),o=e=>(0,i.Ln)({detail:"string"},e),a=e=>(0,i.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,i.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),d=e=>(0,i.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)},76649:function(e,t,n){"use strict";n.d(t,{Ln:function(){return i}});let i=(e,t)=>s(e,t),r=Symbol("SOME"),s=(e,t)=>"string"==typeof e?e===typeof t:Array.isArray(e)?r in e?e.some(e=>s(e,t)):!!Array.isArray(t)&&(0===e.length||t.every(t=>e.some(e=>s(e,t)))):"object"==typeof t&&null!==t&&Object.entries(e).every(([e,n])=>s(n,t[e]));class l{static narrow(e){return new l(t=>i(e,t))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){let t=this.NF,n=e instanceof l?e.NF:e instanceof Function?e:t=>i(e,t);return new l(e=>t(e)&&n(e))}}new l(e=>!0)}},function(e){e.O(0,[6546,2888,9774,179],function(){return e(e.s=6554)}),_N_E=e.O()}]);