"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2163],{37541:function(e,n,a){var t=a(24246),i=a(5702),l=a(18622);n.Z=e=>{let{heading:n,breadcrumbItems:a,isSticky:s=!0,children:r,rightContent:o,style:d,...c}=e;return(0,t.jsxs)("div",{...c,style:s?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,t.jsxs)(i.jqI,{justify:"space-between",children:["string"==typeof n?(0,t.jsx)(i.X6q,{className:a||r?"pb-4":void 0,fontSize:"2xl","data-testid":"page-heading",children:n}):n,o&&(0,t.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!a&&(0,t.jsx)(l.m,{className:r?"pb-4":void 0,items:a,"data-testid":"page-breadcrumb"}),r]})}},51425:function(e,n,a){var t=a(24246),i=a(5702),l=a(39514);n.Z=e=>{let{title:n,tooltip:a,children:s,...r}=e;return(0,t.jsxs)(i.xuv,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",...r,children:[(0,t.jsxs)(i.X6q,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,a?(0,t.jsx)(i.xvT,{as:"span",mx:1,children:(0,t.jsx)(l.Z,{label:a})}):void 0]}),(0,t.jsx)(i.Kqy,{p:6,spacing:6,children:s})]})}},18622:function(e,n,a){a.d(n,{m:function(){return d}});var t=a(24246),i=a(5702),l=a(79894),s=a.n(l),r=a(27378);let{Text:o}=i.AntTypography,d=e=>{let{items:n,...a}=e,l=(0,r.useMemo)(()=>null==n?void 0:n.map((e,a)=>{let i=a===n.length-1,l={...e};return"string"==typeof l.title&&(l.title=(0,t.jsx)(o,{style:{color:"inherit",maxWidth:i?void 0:400},ellipsis:!i,children:l.title})),l.icon&&(l.title=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,t.jsx)(s(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href),l}),[n]);return(0,t.jsx)(i.zrq,{items:l,...a})}},26796:function(e,n,a){a.d(n,{Z:function(){return K}});var t=a(24246),i=a(6903),l=a(5702),s=a(34090),r=a(79894),o=a.n(r),d=a(86677),c=a(27378),u=a(44296),g=a(51425),p=a(34803),h=a(60136),m=a(11032),x=a(43938),v=a(39514),j=a(16781),f=a(79851),b=a(35051),y=a(31241),_=a(27365);let w=e=>{let{index:n}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of privacy notice as displayed to user",variant:"stacked"}),(0,t.jsx)(p.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},C=e=>{let{index:n,name:a,isOOB:i}=e;return(0,t.jsxs)(l.kCb,{direction:"column",gap:6,children:[(0,t.jsxs)(l.X6q,{size:"sm",children:["Edit ",a," translation"]}),i?(0,t.jsx)(y.f,{languageName:a}):null,(0,t.jsx)(w,{index:n})]})},N=e=>{let{translation:n,name:a,onLanguageDeleted:i}=e;return(0,t.jsxs)(l.kCb,{gap:2,direction:"row",w:"100%",children:[(0,t.jsx)(l.OK9,{as:l.wpx,fontWeight:"normal",className:"grow overflow-x-hidden border-gray-300",textOverflow:"ellipsis",_selected:{color:"white",bg:"gray.500"},children:a},n.language),i&&(0,t.jsx)(l.wpx,{"aria-label":"Delete translation",onClick:()=>i(n.language),icon:(0,t.jsx)(l.pJl,{boxSize:3}),className:"min-w-4"})]})};var k=e=>{var n;let{availableTranslations:a}=e,{values:i,setFieldValue:r}=(0,s.u6)(),[o,d]=(0,c.useState)(!1),[p,h]=(0,c.useState)(!1),[m,x]=(0,c.useState)(0),{data:v}=(0,_.tB)({api_set:!1}),j=null==v?void 0:null===(n=v.plus_consent_settings)||void 0===n?void 0:n.enable_translations,f=(0,u.C)(b.Zp),y=(0,u.C)(b.G1);(0,b.Ah)({page:f,size:y});let k=(0,u.C)(b.fJ).slice().sort((e,n)=>e.name.localeCompare(n.name)),T=k.filter(e=>{var n;return null===(n=i.translations)||void 0===n?void 0:n.every(n=>n.language!==e.id)}).map(e=>({label:e.name,value:e.id})),S=e=>{let n=i.translations?i.translations.slice().filter(n=>n.language!==e):[],a=m===n.length?n.length-1:m;r("translations",n),x(a)},O=e=>{var n,a;return null!==(a=null===(n=k.find(n=>n.id===e))||void 0===n?void 0:n.name)&&void 0!==a?a:e};return j?(0,t.jsx)(g.Z,{title:"Localizations",children:(0,t.jsxs)(l.mQc,{index:m,onChange:e=>{x(e),h(!1)},as:l.Ugi,spacing:8,align:"start",w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,t.jsxs)(l.gCW,{spacing:4,minW:"30%",p:2,children:[(0,t.jsx)(l.tdY,{w:"100%",children:(0,t.jsx)(l.gCW,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:i.translations.map(e=>(0,t.jsx)(N,{translation:e,name:O(e.language),onLanguageDeleted:S},e.language))})}),o&&(0,t.jsx)(l.WPr,{autoFocus:!0,defaultOpen:!0,allowClear:!0,placeholder:"Select a language...",options:T,onChange:e=>{let n=null==a?void 0:a.find(n=>n.language===e);h(!!n),x(i.translations.length),r("translations",[...i.translations,null!=n?n:{language:e,title:"",description:""}]),d(!1)},"data-testid":"select-language",className:"w-full"}),!o&&!!T.length&&(0,t.jsx)(l.wpx,{icon:(0,t.jsx)(l.jBn,{boxSize:6}),onClick:()=>d(!0),"data-testid":"add-language-btn",className:"w-full",children:"Add a language"})]}),(0,t.jsx)(l.xuv,{w:"100%",children:(0,t.jsx)(s.F2,{name:"translations",render:()=>(0,t.jsx)(l.nPR,{w:"100%",children:i.translations.map((e,n)=>(0,t.jsx)(l.x45,{children:(0,t.jsx)(C,{index:n,name:O(e.language),isOOB:p})},e.language))})})})]})}):(0,t.jsx)(g.Z,{title:"Notice text",children:(0,t.jsx)(w,{index:0})})},T=a(78973),S=a(59389),O=a(21820),P=a(69236),q=a(10284);let z=(0,O.Jt)(P.ye),E=(0,O.Jt)(P.B8),R=[{language:q.eU.EN,title:"",description:""}],Z={name:"",consent_mechanism:q.J7.OPT_IN,data_uses:[],enforcement_level:q.QT.FRONTEND,disabled:!0,translations:R,children:[]},F=e=>{var n,a,t,i;return{name:null!==(n=e.name)&&void 0!==n?n:Z.name,consent_mechanism:null!==(a=e.consent_mechanism)&&void 0!==a?a:Z.consent_mechanism,data_uses:null!==(t=e.data_uses)&&void 0!==t?t:Z.data_uses,enforcement_level:null!==(i=e.enforcement_level)&&void 0!==i?i:Z.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map(e=>{var n;let{privacy_notice_history_id:a,...t}=e;return{...t,title:null!==(n=e.title)&&void 0!==n?n:""}}):R,children:e.children}},I=S.Ry().shape({name:S.Z_().required().label("Title"),consent_mechanism:S.Z_().required().label("Consent mechanism")});var J=a(14441),L=a.n(J),B=e=>{let{isEditing:n}=e,{values:a,setFieldValue:i}=(0,s.u6)();return(0,c.useEffect)(()=>{n||i("notice_key",L()(a.name))},[a.name,n,i]),(0,t.jsx)(p.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},W=a(40793);let{Text:A}=l.AntTypography,D=e=>{let{regions:n,label:a,tooltip:i}=e;return(0,t.jsxs)(l.gCW,{align:"start",children:[(0,t.jsxs)(l.kCb,{align:"start",children:[a?(0,t.jsx)(l.lXp,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:a}):null,i?(0,t.jsx)(v.Z,{label:i}):null]}),(0,t.jsx)(l.xuv,{w:"100%","data-testid":"notice-locations",children:(0,t.jsxs)(l.vyj,{size:[0,2],wrap:!0,children:[null==n?void 0:n.map(e=>(0,t.jsx)(l.j8w,{children:x.Z8[e]},e)),!(null==n?void 0:n.length)&&(0,t.jsxs)(A,{italic:!0,children:["No locations assigned. Navigate to the"," ",(0,t.jsx)(o(),{href:m.w0,children:"experiences view"})," ","configure."]})]})})]})};var K=e=>{let{privacyNotice:n,availableTranslations:a}=e,r=(0,d.useRouter)(),o=(0,l.pmc)(),x=n?F(n):Z;(0,f.fd)();let v=(0,u.C)(f.qv),b=(0,u.C)(W.sX),y=(0,u.C)(W.Zp),_=(0,u.C)(W.G1);(0,W.J6)({page:y,size:_});let w=e=>{var n;let{id:a}=e,t=b.find(e=>e.id===a);return null!==(n=null==t?void 0:t.name)&&void 0!==n?n:a},C=b.some(e=>{var a;return null===(a=e.children)||void 0===a?void 0:a.some(e=>e.id===(null==n?void 0:n.id))}),[N]=(0,W.vL)(),[S]=(0,W.p4)(),O=(0,c.useMemo)(()=>!!n,[n]),P=async e=>{let a;if(O){var t,i;let l={...e,id:n.id,translations:null!==(t=e.translations)&&void 0!==t?t:[],children:null!==(i=e.children)&&void 0!==i?i:[]};a=await N(l)}else a=await S(e);(0,h.D4)(a)?o((0,j.Vo)((0,h.e$)(a.error))):(o((0,j.t5)("Privacy notice ".concat(O?"updated":"created"))),O||r.push(m.IT))};return(0,t.jsx)(s.J9,{initialValues:x,enableReinitialize:!0,onSubmit:P,validationSchema:I,children:e=>{var o,d;let{values:c,setFieldValue:u,dirty:h,isValid:m,isSubmitting:x}=e;return(0,t.jsx)(s.l0,{children:(0,t.jsxs)(l.Kqy,{spacing:10,children:[(0,t.jsxs)(l.Kqy,{spacing:6,children:[(0,t.jsxs)(g.Z,{title:"Privacy notice details",children:[(0,t.jsx)(p.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,t.jsx)(T.d,{name:"consent_mechanism",label:"Consent mechanism",options:z,isRequired:!0,layout:"stacked"}),(0,t.jsx)(B,{isEditing:O}),(0,t.jsx)(p.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,t.jsx)(D,{regions:null==n?void 0:n.configured_regions,label:"Locations where privacy notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,t.jsx)(l.izJ,{}),!C&&(0,t.jsx)(i.Z,{label:"Child notices",addButtonLabel:"Add notice children",allItems:b.map(e=>({id:e.id,name:e.name})),values:null!==(d=null===(o=c.children)||void 0===o?void 0:o.map(e=>({id:e.id,name:e.name})))&&void 0!==d?d:[],setValues:e=>u("children",e),idField:"id",getItemLabel:w,draggable:!0,maxHeight:100,baseTestId:"children"}),(0,t.jsx)(T.d,{name:"data_uses",label:"Data use",options:v,mode:"multiple",layout:"stacked"}),(0,t.jsx)(T.d,{name:"enforcement_level",label:"Enforcement level",options:E,isRequired:!0,layout:"stacked"})]}),(0,t.jsx)(k,{availableTranslations:a})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.wpx,{onClick:()=>{r.back()},children:"Cancel"}),(0,t.jsx)(l.wpx,{htmlType:"submit",type:"primary",disabled:x||!h||!m,loading:x,"data-testid":"save-btn",children:"Save"})]})]})})}})}},69236:function(e,n,a){a.d(n,{B8:function(){return l},Ep:function(){return s},ye:function(){return i}});var t=a(10284);let i=new Map([[t.J7.OPT_IN,"Opt in"],[t.J7.NOTICE_ONLY,"Notice only"],[t.J7.OPT_OUT,"Opt out"]]),l=new Map([[t.QT.SYSTEM_WIDE,"System wide"],[t.QT.FRONTEND,"Front end"],[t.QT.NOT_APPLICABLE,"Not applicable"]]),s=new Map([["gpp_us_national","GPP US National"],["gpp_us_state","GPP US State"]])}}]);