import{n as L,r as i,ae as V,bX as O,bY as k,ap as H,aB as $,j as l,bq as N,bD as E,br as A,ba as D,bs as F,bW as U,bZ as j,bS as G,bB as K,b_ as Y}from"./index.Ca6320CT.js";import{a as _}from"./useBasicWidgetState.DY0Kwuur.js";import"./FormClearHelper.BP4f-wKq.js";const X=L("div",{target:"euzcfsp0"})(({theme:n})=>({"span[aria-disabled='true']":{background:n.colors.fadedText05}})),q=(n,t)=>n.getIntArrayValue(t),Z=n=>n.default??null,J=n=>n.value??null,Q=(n,t,a,u)=>{t.setIntArrayValue(n,a.value,{fromUi:a.fromUi},u)},ee=n=>{var y;const{element:t,widgetMgr:a,width:u,fragmentId:v}=n,e=V(),[o,g]=_({getStateFromWidgetMgr:q,getDefaultStateFromProto:Z,getCurrStateFromProto:J,updateWidgetMgrState:Q,element:t,widgetMgr:a,fragmentId:v}),m=t.maxSelections>0&&o.length>=t.maxSelections,x=i.useMemo(()=>{if(t.maxSelections===0)return"No results";if(o.length===t.maxSelections){const s=t.maxSelections!==1?"options":"option";return`You can only select up to ${t.maxSelections} ${s}. Remove an option first.`}return"No results"},[t.maxSelections,o.length]),z=i.useMemo(()=>o.map(s=>{const r=t.options[s];return{value:s.toString(),label:r}}),[t.options,o]),h=i.useCallback(s=>{const r=()=>{var d;const p=(d=s.option)==null?void 0:d.value;return parseInt(p,10)};switch(s.type){case"remove":return O(o,r());case"clear":return[];case"select":return o.concat([r()]);default:throw new Error(`State transition is unknown: ${s.type}`)}},[o]),w=i.useCallback(s=>{t.maxSelections&&s.type==="select"&&o.length>=t.maxSelections||g({value:h(s),fromUi:!0})},[t.maxSelections,h,g,o.length]),I=i.useCallback((s,r)=>{if(m)return[];const p=s.filter(d=>!o.includes(Number(d.value)));return k(p,r)},[m,o]),R={width:u},{options:c}=t,b=c.length===0?!0:n.disabled,M=c.length===0?"No options to select.":t.placeholder,T=c.map((s,r)=>({label:s,value:r.toString()})),W=c.length>10,[S,P]=i.useState(0),[f,C]=i.useState(!1),B=i.useCallback(()=>f?S:!o||o.length===0?0:o[o.length-1]*H(e.sizes.dropdownItemHeight),[o,f,S,e.sizes.dropdownItemHeight]);return $("div",{className:"stMultiSelect","data-testid":"stMultiSelect",style:R,children:[l(F,{label:t.label,disabled:b,labelVisibility:N((y=t.labelVisibility)==null?void 0:y.value),children:t.help&&l(E,{children:l(A,{content:t.help,placement:D.TOP_RIGHT})})}),l(X,{children:l(U,{options:T,labelKey:"label",valueKey:"value","aria-label":t.label,placeholder:M,type:j.select,multi:!0,onChange:w,value:z,disabled:b,size:"compact",noResultsMsg:x,filterOptions:I,closeOnSelect:!1,overrides:{Popover:{props:{overrides:{Body:{style:()=>({marginTop:e.spacing.px})}}}},SelectArrow:{component:G,props:{overrides:{Svg:{style:()=>({width:e.iconSizes.xl,height:e.iconSizes.xl})}}}},IconsContainer:{style:()=>({paddingRight:e.spacing.sm})},ControlContainer:{style:{minHeight:e.sizes.minElementHeight,borderLeftWidth:e.sizes.borderWidth,borderRightWidth:e.sizes.borderWidth,borderTopWidth:e.sizes.borderWidth,borderBottomWidth:e.sizes.borderWidth}},Placeholder:{style:()=>({flex:"inherit",opacity:"0.7"})},ValueContainer:{style:()=>({paddingLeft:e.spacing.sm,paddingTop:e.spacing.none,paddingBottom:e.spacing.none,paddingRight:e.spacing.none})},ClearIcon:{props:{overrides:{Svg:{style:{color:e.colors.darkGray,padding:e.spacing.threeXS,height:e.sizes.clearIconSize,width:e.sizes.clearIconSize,cursor:"pointer",":hover":{fill:e.colors.bodyText}}}}}},SearchIcon:{style:{color:e.colors.darkGray}},Tag:{props:{overrides:{Root:{style:{borderTopLeftRadius:e.radii.md,borderTopRightRadius:e.radii.md,borderBottomRightRadius:e.radii.md,borderBottomLeftRadius:e.radii.md,fontSize:e.fontSizes.md,paddingLeft:e.spacing.sm,marginLeft:e.spacing.none,marginRight:e.spacing.sm,height:`calc(${e.sizes.minElementHeight} - 2 * ${e.spacing.xs})`,maxWidth:`calc(100% - ${e.spacing.lg})`,cursor:"default !important"}},Action:{style:{paddingLeft:0}},ActionIcon:{props:{overrides:{Svg:{style:{width:"0.625em",height:"0.625em"}}}}}}}},MultiValue:{props:{overrides:{Root:{style:{fontSize:e.fontSizes.sm}}}}},Input:{props:{readOnly:K&&W===!1?"readonly":null}},Dropdown:{component:Y,props:{$menuListProps:{initialScrollOffset:B(),onScroll:s=>{C(!0),P(s)}}}}}})})]})},ne=i.memo(ee);export{ne as default};
