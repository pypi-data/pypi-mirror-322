(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[803],{96597:function(e,t,a){Promise.resolve().then(a.bind(a,7840))},7840:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(57437),i=a(2265),r=a(14735),s=a(6877),l=a(59511),o=a(74686);function c(e){let{initialProjectState:t}=e,[a,c]=i.useState((0,r.fV)()),[u,d]=i.useState(t),[h,f]=i.useState({python:u.python,requirements:u.requirements}),{fsWorkerComm:p,fsReady:g}=(0,l.VC)({pageId:a}),[m,y]=i.useState(!1);return i.useEffect(()=>{let e=!1,t=async()=>{let t=u.code,a=u.requirements,n={...u};if(t.startsWith("http://")||t.startsWith("https://")){let e=await fetch("/i/request_proxy?uri=".concat(t));t=await e.text(),n={...n,code:t}}if((a.startsWith("http://")||a.startsWith("https://"))&&a.endsWith(".txt")){let e=await fetch("/i/request_proxy?uri=".concat(a));a=await e.text(),n={...n,requirements:a}}await (0,o._R)({projectState:n,fsWorkerComm:p}),e||(f({...h,requirements:u.requirements}),d(n),y(!0))};return g&&t(),()=>{e=!0}},[g,a]),(0,n.jsx)(n.Fragment,{children:m?(0,n.jsx)(s.Z,{type:u.type,start:"",pageId:a,python:h.python},"python-".concat(a)):(0,n.jsx)("div",{children:"Loading filesystem"})})}var u=a(93646),d=a(7032);function h(){let e=i.useMemo(()=>window.location.search.includes("iframe"),[]),[t,a]=i.useState(null),[r,s]=i.useState(null),[l,o]=i.useState(null);return(i.useEffect(()=>{console.info("listening for messages"),window.parent.postMessage("ready","*");let e=async e=>{if(console.error("Received message",e.data),"loadProject"===e.data.type){let t=e.data.projectData,a=t.signatureJwt;if(null===a){s(t.projectState),o("trial");return}await (0,u.gW)(t.projectState,a)?(s(t.projectState),o("valid")):o("invalid")}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),t)?(0,n.jsx)("h2",{children:t}):null!==r?(0,n.jsxs)(n.Fragment,{children:["invalid"===l&&(0,n.jsx)("h1",{children:"Error: Invalid signature"}),"trial"===l&&d.Xd.isPublic&&(0,n.jsxs)("h3",{children:["Trial version, if you would like to remove this message, please contact us at"," ",(0,n.jsx)("a",{href:"https://py.cafe/contact",target:"_blank",children:"PyCafe"})]}),"trial"===l&&!d.Xd.isPublic&&(0,n.jsxs)("h3",{children:["This file was created with a trial account, please obtain a license key at"," ",(0,n.jsx)("a",{href:"https://py.cafe/contact",target:"_blank",children:"PyCafe"})]}),(0,n.jsx)("div",{id:"iframe-parent",style:{display:"flex",flexDirection:"column",alignItems:"stretch",height:"100dvh",background:"none",backgroundColor:"var(--color-material-background)"},children:(0,n.jsx)("div",{style:{flex:"1 0 0"},children:(0,n.jsx)(c,{initialProjectState:r})})})]}):e?(0,n.jsx)("h1",{children:"Loading project..."}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("p",{children:"Dragging in files not yet implemented, the viewer can only be used by opening an exported file."})})}}},function(e){e.O(0,[576,72,959,780,384,218,155,684,36,144,70,92,686,971,117,744],function(){return e(e.s=96597)}),_N_E=e.O()}]);