"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8268],{16204:function(e,n,t){t.d(n,{Z:function(){return b}});var r=t(26068),a=t.n(r),s=t(48305),l=t.n(s),o=t(67825),i=t.n(o),c=t(43943),u=t(23333),d=t(76808),f=t(32699),m=t(50959),p=t(38780),h=t(11527),v=function(e){var n=e.isOverflowing,t=e.showTitle,r=e.title,a=e.children,s=(0,p.Z)().initialize,l=m.useRef(null);return m.useEffect((function(){l.current&&s(l.current)}),[s,l.current]),(0,h.jsx)("div",{style:{maxHeight:200,overflowY:"auto"},ref:l,children:(0,h.jsx)("div",{style:{width:"max-content",maxWidth:250,paddingInline:10},children:n||t?r||a:""})})},g=m.memo(v),x=["children","maxWidth","minWidth","ghost","title","showTitle","tooltipProps"],y=function(e){var n=e.children,t=e.maxWidth,r=void 0===t?"100%":t,s=e.minWidth,o=e.ghost,p=void 0!==o&&o,v=e.title,y=e.showTitle,b=void 0!==y&&y,j=e.tooltipProps,w=i()(e,x),k=(0,m.useRef)(null),S=(0,m.useState)(!1),Z=l()(S,2),M=Z[0],_=Z[1],N=(0,m.useCallback)((function(){if(k.current){var e=k.current,n=e.scrollWidth,t=e.clientWidth;_(n>t)}}),[k.current]);(0,m.useEffect)((function(){var e=k.current;if(e){var n=new ResizeObserver((function(){N()}));return n.observe(e),N(),function(){return n.disconnect()}}}),[N]),(0,m.useEffect)((function(){var e=(0,f.throttle)(N,200);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),e.cancel()}}),[N]),(0,m.useEffect)((function(){N()}),[n,N]);var C=(0,m.useMemo)((function(){return a()({maxWidth:r,minWidth:s,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},w.style)}),[r,w.style]);return(0,h.jsx)(u.Z,a()(a()({overlayInnerStyle:{paddingInline:0},destroyTooltipOnHide:!1,title:M||b?(0,h.jsx)(g,{isOverflowing:M,title:v,showTitle:b,children:n}):""},j),{},{children:p?(0,h.jsx)("div",{ref:k,style:C,"data-overflow":M,children:n}):(0,h.jsx)(d.Z,a()(a()({},w),{},{ref:k,style:a()(a()({},C),{},{paddingInline:w.closable?"8px 22px":8,borderRadius:12}),closeIcon:!!w.closable&&(0,h.jsx)(c.Z,{style:{position:"absolute",right:8,top:8}}),children:n}))}))},b=m.memo(y)},97791:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ye}});var r=t(90228),a=t.n(r),s=t(87999),l=t.n(s),o=t(48305),i=t.n(o),c=t(49280),u=t(37963),d=t(82344),f=t(69997),m=t(57989),p=t(92067),h=t(63830),v=t(67581),g=t(35374),x=t(54235),y=t(85885),b=t(96938),j=t(47946),w=t(82187),k=t.n(w),S=t(32699),Z=t.n(S),M=t(50959),_=t(94299),N=t(91082),C=t(26068),R=t.n(C),P=t(15558),I=t.n(P),O=t(38780),T=t(69510),A=t(54876),E=(t(99951),t(1731)),z=(t(29031),t(76223),t(19427)),F=(t(64818),t(63417)),L=t(81e3),D=t(23333),W=t(8267),G=t(42326),U=t(76574),V=t(11527),B=function(e){var n,t,r,s=e.updateMessage,o=e.onDelete,i=e.loading,c=e.data,u=e.editable,d=e.showTitle,f=void 0===d||d,m=e.actions,p=void 0===m?["upload","delete","copy"]:m,h=(0,g.useIntl)(),v=(0,M.useRef)(null),x=(0,M.useRef)(0),b=(0,M.useCallback)(function(){var e=l()(a()().mark((function e(n){var t,r,l,o,i,u,d;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.clipboardData||window.clipboardData,r=t.items,l=[],o=a()().mark((function e(){var n,t,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"file"===(n=r[i]).kind&&-1!==n.type.indexOf("image")?(t=n.getAsFile(),s=new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var r,a=null===(r=t.target)||void 0===r?void 0:r.result;a?e(a):n("Failed to convert image to base64")},r.readAsDataURL(t)})),l.push(s)):n.kind;case 2:case"end":return e.stop()}}),e)})),i=0;case 5:if(!(i<r.length)){e.next=10;break}return e.delegateYield(o(),"t0",7);case 7:i++,e.next=5;break;case 10:return e.prev=10,e.next=13,Promise.all(l);case 13:(u=e.sent).length&&(d=Z().map(u,(function(e){return x.current+=1,{uid:x.current,dataUrl:e}})),null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:[].concat(I()(c.imgs||[]),I()(d))})),e.next=20;break;case 17:e.prev=17,e.t1=e.catch(10);case 20:case"end":return e.stop()}}),e,null,[[10,17]])})));return function(n){return e.apply(this,arguments)}}(),[c,s]),j=(0,M.useCallback)((function(e){null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:[].concat(I()(c.imgs||[]),I()(e))})}),[c,s]),w=function(e){var n=Z().filter(c.imgs,(function(n){return n.uid!==e}));null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:n})},S=(0,M.useCallback)((function(){var e;if(c.imgs&&(null===(e=c.imgs)||void 0===e?void 0:e.length)>0){var n=I()(c.imgs||[]).pop();n&&w(n.uid)}}),[c.imgs,w]),_=(0,M.useCallback)((function(e){var n;"Backspace"===e.key&&""===c.content&&c.imgs&&(null===(n=c.imgs)||void 0===n?void 0:n.length)>0&&(e.preventDefault(),S())}),[c,S]);return(0,V.jsxs)("div",{className:"content-item",children:[(0,V.jsxs)("div",{className:"content-item-role",style:{display:f||p.length?"flex":"none"},children:[f&&(0,V.jsx)("div",{className:"role",children:null!==(n=c.title)&&void 0!==n?n:h.formatMessage({id:"playground.".concat(c.role)})}),(0,V.jsxs)("div",{className:"actions",children:[p.includes("upload")&&c.role===E.G7.User&&(0,V.jsx)(U.Z,{handleUpdateImgList:j}),c.content&&p.includes("copy")&&(0,V.jsx)(F.Z,{text:c.content,size:"small",shape:"default",type:"text",fontSize:"12px"}),p.includes("delete")&&(0,V.jsx)(D.Z,{title:h.formatMessage({id:"common.button.delete"}),children:(0,V.jsx)(y.ZP,{size:"small",type:"text",onClick:o,icon:(0,V.jsx)(L.Z,{})})})]})]}),u?(0,V.jsxs)("div",{className:k()("message-content-input",{"has-img":null===(t=c.imgs)||void 0===t?void 0:t.length}),onClick:function(e){e.stopPropagation(),e.preventDefault(),v.current.focus()},children:[(0,V.jsx)(G.Z,{editable:u,dataList:c.imgs||[],onDelete:w}),(0,V.jsx)(W.Z.TextArea,{ref:v,value:c.content,variant:"filled",autoSize:{minRows:1},style:{borderRadius:"var(--border-radius-mini)"},readOnly:i,onKeyDown:_,onChange:function(e){null==s||s({imgs:c.imgs||[],role:c.role,content:e.target.value,uid:c.uid})},onPaste:function(e){e.clipboardData.getData("text")||(e.preventDefault(),b(e))}})]}):(0,V.jsxs)("div",{className:k()("content-item-content",{"has-img":null===(r=c.imgs)||void 0===r?void 0:r.length}),children:[(0,V.jsx)(G.Z,{editable:u,dataList:c.imgs||[],onDelete:w}),c.content&&(0,V.jsx)("div",{className:"text",children:c.content})]})]})},q=M.memo(B),H=function(e){var n=e.setMessageList,t=e.messageList,r=e.editable,a=e.showTitle,s=void 0===a||a,l=e.actions,o=void 0===l?["upload","delete","copy"]:l;return(0,V.jsx)(V.Fragment,{children:!!t.length&&(0,V.jsx)("div",{className:"message-content-list",children:t.map((function(e,a){return(0,V.jsx)(q,{data:e,editable:r,actions:o,showTitle:s,onDelete:function(){return function(e){var r=I()(t);r.splice(e,1),null==n||n(r)}(a)},updateMessage:function(e){return function(e,r){var a=I()(t);a[e]=r,null==n||n(a)}(a,e)}},e.uid)}))})})},J=M.memo(H),K=t(43943),Y=t(83603),$=t(76571),Q=function(e){var n=e.systemMessage,t=e.showApplyToAll,r=e.setSystemMessage,a=e.style,s=e.applyToAll,l=(0,g.useIntl)(),o=(0,M.useState)(!1),c=i()(o,2),u=c[0],d=c[1],f=M.useRef(null),m=(0,M.useState)({minRows:1,maxRows:1,focus:!1}),p=i()(m,2),h=p[0],v=p[1],x=function(){v({minRows:4,maxRows:4,focus:!0}),setTimeout((function(){var e,n;null===(e=f.current)||void 0===e||null===(n=e.focus)||void 0===n||n.call(e,{cursor:"end"})}),100)};return(0,M.useEffect)((function(){u&&(null==s||s(n))}),[u]),(0,V.jsxs)("div",{className:k()("sys-message",{focus:h.focus}),style:R()({},a),children:[(0,V.jsxs)("div",{style:{display:h.focus?"block":"none"},className:"textarea-wrapper",children:[(0,V.jsx)("span",{className:"system-label",children:l.formatMessage({id:"playground.systemMessage"})}),(0,V.jsx)(W.Z.TextArea,{className:"custome-scrollbar",ref:f,variant:"filled",placeholder:l.formatMessage({id:"playground.system.tips"}),style:{borderRadius:"0",border:"none"},value:n,autoSize:{minRows:h.minRows,maxRows:h.maxRows},onFocus:x,onBlur:function(e){v({minRows:1,maxRows:1,focus:!1})},allowClear:!1,onChange:function(e){r(e.target.value),u&&(null==s||s(e.target.value))}}),t&&(0,V.jsxs)("span",{className:"apply-check",onMouseDown:function(e){e.preventDefault(),d(!u)},children:[(0,V.jsx)("span",{className:"m-r-5",children:l.formatMessage({id:"playground.compare.applytoall"})}),(0,V.jsx)(Y.Z,{checked:u})]}),(0,V.jsx)($.Z,{style:{margin:"0"}})]}),!h.focus&&(0,V.jsxs)("div",{className:"sys-content-wrap",onClick:x,children:[(0,V.jsxs)("div",{className:"sys-content",children:[(0,V.jsx)("span",{className:"title",children:l.formatMessage({id:"playground.systemMessage"})}),n||(0,V.jsx)("span",{style:{color:"var(--ant-color-text-tertiary)"},children:l.formatMessage({id:"playground.system.tips"})})]}),n&&(0,V.jsx)(D.Z,{title:l.formatMessage({id:"common.button.clear"}),children:(0,V.jsx)(y.ZP,{className:"clear-btn",type:"text",icon:(0,V.jsx)(K.Z,{}),size:"small",onClick:function(){r("")}})})]})]})},X=M.memo(Q),ee=t(82092),ne=t.n(ee),te=t(1436),re=t(39139),ae=t(55825),se=t(66389),le=t(4423),oe=t(68476),ie=t(40474),ce=t(96247),ue=t(35897),de={seed:"seed",stop:"stop",temperature:"temperature",top_p:"top_p",n_ctx:"n_ctx",n_slot:"n_slot",max_model_len:"max_model_len"},fe=function(e){var n=e.selectedModel,t=e.setParams,r=e.globalParams,a=e.onValuesChange,s=e.modelList,l=e.showModelSelector,o=void 0===l||l,c=(0,g.useIntl)(),u=R()({seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024},r),d=oe.Z.useForm(),f=i()(d,1)[0],m=(0,M.useId)(),p=(0,M.useState)({}),h=i()(p,2),v=h[0],x=h[1],y=(0,M.useState)(!0),b=i()(y,2),j=b[0],w=b[1],k=(0,M.useCallback)((function(e,n){null==t||t(n),null==a||a(e,n)}),[a,t]),S=(0,M.useCallback)((function(e,n){var r=f.getFieldsValue();f.setFieldsValue(R()(R()({},r),{},ne()({},n,e))),t(R()(R()({},r),{},ne()({},n,e))),null==a||a(ne()({},n,e),R()(R()({},r),{},ne()({},n,e)))}),[f,t,a]),_=function(e){var n=Z().find(s,{value:e}),t=(null==n?void 0:n.meta)||{},r=Z().pick(t,Z().keys(de)),a=Object.entries(de).reduce((function(e,n){var t=i()(n,2),a=t[0],s=t[1],l=r[a];return l&&Z().hasIn(r,a)&&(e[s]=l),e}),{}),l=1024;return a.n_ctx&&a.n_slot?l=Z().divide(a.n_ctx/2,a.n_slot):a.max_model_len&&(l=a.max_model_len/2),f.setFieldsValue(R()(R()({},Z().omit(a,["n_ctx","n_slot","max_model_len"])),{},{max_tokens:l})),x(R()(R()({},a),{},{max_tokens:a.max_model_len||Z().divide(a.n_ctx,a.n_slot)})),R()(R()({},Z().omit(a,["n_ctx","n_slot","max_model_len"])),{},{max_tokens:l})};(0,M.useEffect)((function(){var e=n||"";o&&(e=e||Z().get(s,"[0].value"));var r=_(e),a=Z().merge({},u,r);f.setFieldsValue(R()(R()({},a),{},{model:e})),t(R()(R()({},a),{},{model:e})),w(!1)}),[s,o,n]),(0,M.useEffect)((function(){j||f.setFieldsValue(r)}),[r,j]);var N=function(e){return(0,V.jsxs)("span",{className:ue.Z.label,style:{width:se.d.mini},children:[(0,V.jsx)("span",{className:"text",children:e.description?(0,V.jsxs)(D.Z,{title:e.description,children:[(0,V.jsxs)("span",{children:[" ",e.label]}),(0,V.jsx)("span",{className:"m-l-5",children:(0,V.jsx)(le.Z,{})})]}):(0,V.jsx)("span",{children:e.label})}),(0,V.jsx)(ie.Z,{className:"label-val",variant:"outlined",size:"small",value:f.getFieldValue(e.field),controls:!1,onChange:function(n){return S(n,e.field)}})]})};return(0,V.jsx)(oe.Z,{name:m,form:f,onValuesChange:k,onFinish:function(e){},onFinishFailed:function(e){},children:(0,V.jsxs)("div",{children:[o&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("h3",{className:"m-b-20 m-l-10 font-size-14 line-24",children:c.formatMessage({id:"playground.model"})}),(0,V.jsx)(oe.Z.Item,{name:"model",rules:[{required:!0,message:c.formatMessage({id:"common.form.rule.select"},{name:c.formatMessage({id:"playground.model"})})}],children:(0,V.jsx)(ae.Z,{showSearch:!0,options:s,onChange:_})})]}),(0,V.jsx)("h3",{className:"m-b-20 m-l-10 flex-between flex-center font-size-14 line-24",children:(0,V.jsx)("span",{children:c.formatMessage({id:"playground.parameters"})})}),(0,V.jsx)(oe.Z.Item,{name:"temperature",rules:[{required:!1}],children:(0,V.jsx)(te.Z,{label:N({field:"temperature",label:"Temperature",description:c.formatMessage({id:"playground.params.temperature.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,V.jsx)(ce.Z,{defaultValue:1,max:2,step:.1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:f.getFieldValue("temperature")||void 0,onChange:function(e){return S(e,"temperature")}})})}),(0,V.jsx)(oe.Z.Item,{name:"max_tokens",rules:[{required:!1}],children:(0,V.jsx)(te.Z,{label:N({field:"max_tokens",label:"Max Tokens",description:c.formatMessage({id:"playground.params.maxtokens.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,V.jsx)(ce.Z,{defaultValue:2048,max:v.max_tokens||16384,step:1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:f.getFieldValue("max_tokens")||void 0,onChange:function(e){return S(e,"max_tokens")}})})}),(0,V.jsx)(oe.Z.Item,{name:"top_p",rules:[{required:!1}],children:(0,V.jsx)(te.Z,{label:N({field:"top_p",label:"Top P",description:c.formatMessage({id:"playground.params.topp.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,V.jsx)(ce.Z,{defaultValue:1,max:1,step:.1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:f.getFieldValue("top_p")||void 0,onChange:function(e){return S(e,"top_p")}})})}),(0,V.jsx)(oe.Z.Item,{name:"seed",rules:[{required:!1}],children:(0,V.jsx)(re.Z.Number,{label:"Seed",min:0,description:c.formatMessage({id:"playground.params.seed.tips"}),style:{width:se.d.mini}})}),(0,V.jsx)(oe.Z.Item,{name:"stop",rules:[{required:!1}],normalize:function(e){return e||null},children:(0,V.jsx)(re.Z.Input,{allowClear:!0,label:"Stop Sequence",description:c.formatMessage({id:"playground.params.stop.tips"}),style:{width:se.d.mini}})})]})})},me=(0,M.memo)(fe),pe=t(78093),he=t(87497),ve=function(e){var n=(0,g.useIntl)(),t=e.usage,r=e.showOutput,a=void 0===r||r,s=e.scaleable,l=e.fields,o=void 0===l?["completion_tokens","prompt_tokens"]:l;return!t||Z().isEmpty(t)?null:t.error?(0,V.jsxs)(he.Z.Paragraph,{type:"danger",ellipsis:{rows:2,tooltip:null==t?void 0:t.errorMessage},style:{textAlign:"center",paddingBlock:0,margin:0,backgroundColor:"var(--ant-color-error-bg)"},children:[(0,V.jsx)(pe.Z,{className:"m-r-8"}),null==t?void 0:t.errorMessage]}):(0,V.jsxs)("div",{className:k()("reference-params",{scaleable:s}),children:[(0,V.jsx)("span",{className:k()("usage",{scaleable:s}),children:(0,V.jsx)(D.Z,{title:(0,V.jsxs)(x.Z,{children:[o.includes("completion_tokens")&&(0,V.jsxs)("span",{children:[n.formatMessage({id:"playground.completion"}),":"," ",t.completion_tokens]}),o.includes("prompt_tokens")&&(0,V.jsxs)("span",{children:[n.formatMessage({id:"playground.prompt"}),":"," ",t.prompt_tokens]})]}),children:(0,V.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenusage"}),":"," ",t.total_tokens]})})}),a&&(0,V.jsx)("span",{className:k()("usage",{scaleable:s}),children:(0,V.jsx)(D.Z,{title:(0,V.jsxs)(x.Z,{children:[(0,V.jsxs)("span",{children:["TPOT: ",Z().round(t.time_per_output_token_ms,2)||0," ms"]}),(0,V.jsxs)("span",{children:["TTFT: ",Z().round(t.time_to_first_token_ms,2)||0," ms"]})]}),children:(0,V.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenoutput"}),":"," ",Z().round(t.tokens_per_second,2)||0," Tokens/s"]})})})]})},ge=t(31759),xe=t.n(ge),ye=t(37616),be=t(43585),je=t(90515),we=t(1956),ke="bash",Se="python",Ze="javascript",Me=[{label:"Curl",value:ke},{label:"Python",value:Se},{label:"Nodejs",value:Ze}],_e=function(e){var n=e||{},t=n.title,r=n.open,a=n.api,s=n.clientType,l=n.logcommand,o=n.onCancel,c=n.payload,u=n.parameters,d=void 0===u?{}:u,f=(0,g.useIntl)(),m=(0,M.useState)(ke),p=i()(m,2),h=p[0],v=p[1],x="".concat(window.location.origin,"/v1-openai"),b=(0,M.useMemo)((function(){var e=l?"console.log(response.".concat(l,");\n"):"",n=l?"print(response.".concat(l,")"):"";if(h===ke)return"curl ".concat(window.location.origin,"/v1-openai/").concat(a,' \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-d \'').concat(JSON.stringify(R()(R()({},d),c),null,2),"'");if(h===Ze)return'const OpenAI = require("openai");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(x,'"\n});\n\nasync function main(){\n  const params = ').concat(JSON.stringify(R()(R()({},d),c),null,4),";\nconst response = await openai.").concat(s,"(params);\n  ").concat(e,"}\nmain();");if(h===Se){var t=Z().keys(d).reduce((function(e,n){if(null===d[n])return e;var t="string"==typeof d[n]?'"'.concat(d[n],'"'):d[n];return e+"  ".concat(n,"=").concat(t,",\n")}),""),r=function(e){return Z().keys(e).reduce((function(n,t){if(null===e[t])return n;var r="object"===xe()(e[t])?JSON.stringify(e[t],null,2):'"'.concat(e[t],'"');return n+"  ".concat(t,"=").concat(r,",\n")}),"")}(c);return'from openai import OpenAI\n\nclient = OpenAI(\n  base_url="'.concat(x,'", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\nresponse = client.').concat(s,"(\n").concat(t).concat(r,")\n").concat(n)}return""}),[h,c,d,a,s,l]);return(0,V.jsx)(V.Fragment,{children:(0,V.jsxs)(we.Z,{title:t,open:r,centered:!0,onCancel:function(){v(ke),o()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,V.jsx)("div",{style:{marginBottom:"10px"},children:f.formatMessage({id:"playground.viewcode.info"})}),(0,V.jsxs)("div",{children:[(0,V.jsx)(ye.Z,{copyText:b,langOptions:Me,defaultValue:ke,showHeader:!0,onChangeLang:function(e){v(e)},styles:{wrapper:{backgroundColor:"var(--color-editor-dark)"}},children:(0,V.jsx)("div",{style:{paddingRight:2,paddingBottom:2},children:(0,V.jsx)(be.Z,{height:380,theme:"dark",code:b,lang:h,copyable:!1})})}),(0,V.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,V.jsx)(je.Z,{className:"m-r-8"}),(0,V.jsx)("span",{children:f.formatMessage({id:"playground.viewcode.tips"},{here:(0,V.jsx)(y.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,V.jsxs)("span",{children:[" ",f.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})},Ne=M.memo(_e),Ce=(0,M.forwardRef)((function(e,n){var t=e.modelList,r=(0,M.useRef)(0),s=(0,M.useState)([]),o=i()(s,2),c=o[0],u=o[1],d=(0,g.useIntl)(),f=(0,g.useSearchParams)(),m=i()(f,1)[0].get("model")||"",p=(0,M.useState)({}),h=i()(p,2),v=h[0],x=h[1],y=(0,M.useState)(""),b=i()(y,2),j=b[0],w=b[1],S=(0,M.useState)(!1),_=i()(S,2),C=_[0],P=_[1],F=(0,M.useState)(!1),L=i()(F,2),D=L[0],W=L[1],G=(0,M.useState)(null),U=i()(G,2),B=U[0],q=U[1],H=(0,M.useState)(!1),K=i()(H,2),Y=K[0],$=K[1],Q=(0,M.useRef)(""),ee=(0,M.useRef)(null),ne=(0,M.useRef)(null),te=(0,M.useRef)(null),re=(0,M.useRef)(null),ae=(0,M.useRef)(0),se=(0,O.Z)(),le=se.initialize,oe=se.updateScrollerPosition,ie=(0,O.Z)().initialize;(0,M.useImperativeHandle)(n,(function(){return{viewCode:function(){P(!0)},setCollapse:function(){$(!Y)},collapse:Y}}));var ce=(0,M.useMemo)((function(){return(0,E.kA)([{role:E.G7.System,content:j}].concat(I()(c)))}),[c,j]),ue=function(){r.current=r.current+1},de=function(e){var n;q(R()({},null!==(n=null==e?void 0:e.usage)&&void 0!==n?n:{})),e&&Z().get(e,"choices",[]).length&&(Q.current=Q.current+Z().get(e,"choices.0.delta.content",""),u([].concat(I()(c),I()(te.current),[{role:E.G7.Assistant,content:Q.current,uid:r.current}])))},fe=function(){var e=l()(a()().mark((function e(n){var t,s,l,o,i,d,f,m,p,h,g;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.model){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,W(!0),ue(),q(null),null===(t=ee.current)||void 0===t||null===(s=t.abort)||void 0===s||s.call(t),ee.current=new AbortController,l=ee.current.signal,te.current=n?[R()(R()({},n),{},{uid:r.current})]:[],Q.current="",u((function(e){return[].concat(I()(e),I()(te.current))})),o=[{role:E.G7.System,content:j}].concat(I()(c),I()(te.current)),i=(0,E.kA)(o),d=R()(R()({messages:i},v),{},{stream:!0,stream_options:{include_usage:!0}}),e.next=17,(0,T.U3)({data:d,url:N.qt,signal:l});case 17:if(null==(f=e.sent)||!f.error){e.next=21;break}return q({error:!0,errorMessage:(null==f||null===(m=f.data)||void 0===m||null===(m=m.error)||void 0===m?void 0:m.message)||(null==f||null===(p=f.data)||void 0===p?void 0:p.message)||""}),e.abrupt("return");case 21:return ue(),h=f.reader,g=f.decoder,e.next=25,(0,T.LN)(h,g,(function(e){var n;null!=e&&e.error?q({error:!0,errorMessage:(null==e||null===(n=e.error)||void 0===n?void 0:n.message)||(null==e?void 0:e.message)||""}):de(e)}));case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(2);case 30:return e.prev=30,W(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[2,27,30,33]])})));return function(n){return e.apply(this,arguments)}}();Z().throttle(oe,100);return(0,M.useEffect)((function(){ne.current&&le(ne.current)}),[ne.current,le]),(0,M.useEffect)((function(){re.current&&ie(re.current)}),[re.current,ie]),(0,M.useEffect)((function(){D&&oe()}),[c,D]),(0,M.useEffect)((function(){c.length>ae.current&&oe(),ae.current=c.length}),[c.length]),(0,V.jsxs)("div",{className:"ground-left-wrapper",children:[(0,V.jsxs)("div",{className:"ground-left",children:[(0,V.jsx)("div",{className:"message-list-wrap",ref:ne,children:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{style:{marginBottom:20},children:(0,V.jsx)(X,{style:{borderRadius:"var(--border-radius-mini)",overflow:"hidden"},systemMessage:j,setSystemMessage:w})}),(0,V.jsxs)("div",{className:"content",children:[(0,V.jsx)(J,{messageList:c,setMessageList:u,editable:!0,loading:D}),D&&(0,V.jsx)(A.Z,{size:"small",children:(0,V.jsx)("div",{style:{height:"46px"}})})]})]})}),B&&(0,V.jsx)("div",{style:{height:40},children:(0,V.jsx)(ve,{usage:B})}),(0,V.jsx)("div",{className:"ground-left-footer",children:(0,V.jsx)(z.Z,{defaultSize:{minRows:5,maxRows:5},loading:D,disabled:!v.model,isEmpty:!c.length,handleSubmit:function(e){var n,t=e.content||null!==(n=e.imgs)&&void 0!==n&&n.length?e:void 0;fe(t)},addMessage:function(e){var n,t=e||{role:(null===(n=Z().last(c))||void 0===n?void 0:n.role)===E.G7.User?E.G7.Assistant:E.G7.User,content:""};c.push(R()(R()({},t),{},{uid:r.current+1})),ue(),u(I()(c))},handleAbortFetch:function(){var e,n;null===(e=ee.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),W(!1)},clearAll:function(){c.length&&(ue(),u([]),q(null))},setModelSelections:function(){},presetPrompt:function(e){var n,t=e.filter((function(e){return"system"===e.role})),a=e.filter((function(e){return"user"===e.role})).map((function(e){return ue(),R()(R()({},e),{},{uid:r.current})}));w((null===(n=t[0])||void 0===n?void 0:n.content)||""),u(a)}})})]}),(0,V.jsx)("div",{className:k()("params-wrapper",{collapsed:Y}),ref:re,children:(0,V.jsx)("div",{className:"box",children:(0,V.jsx)(me,{setParams:x,params:v,selectedModel:m,modelList:t})})}),(0,V.jsx)(Ne,R()(R()({},E.NW.chat),{},{open:C,payload:{messages:ce},parameters:v,onCancel:function(){P(!1)},title:d.formatMessage({id:"playground.viewcode"})}))]})})),Re=(0,M.memo)(Ce),Pe=M.createContext({}),Ie=t(23010),Oe=function(e){var n=e.style,t=(0,g.useIntl)();(0,g.useNavigate)();return(0,V.jsx)("div",{className:"flex-center  justify-center",style:R()({},n),children:(0,V.jsx)(Ie.Z,{image:Ie.Z.PRESENTED_IMAGE_SIMPLE,description:(0,V.jsx)("div",{className:"flex-column",children:(0,V.jsx)(he.Z.Text,{type:"secondary",children:t.formatMessage({id:"playground.model.noavailable"})})})})})},Te=t(81745),Ae=t(7922),Ee=t(16204),ze=t(51076),Fe=t(69070),Le=t(1404),De=t(43211),We=t(60857),Ge=t(8964),Ue=t(40918),Ve=(0,M.forwardRef)((function(e,n){var t=e.model,r=e.modelList,s=e.instanceId,o=(0,M.useContext)(Pe),u=o.globalParams,d=o.setGlobalParams,f=o.setLoadingStatus,m=o.handleDeleteModel,p=o.handleApplySystemChangeToAll,h=o.modelFullList,v=o.loadingStatus,x=(0,g.useIntl)(),b=(0,M.useRef)(!1),j=(0,M.useState)(""),w=i()(j,2),k=w[0],S=w[1],_=(0,M.useState)({model:t}),C=i()(_,2),P=C[0],z=C[1],F=(0,M.useState)(!1),L=i()(F,2),D=L[0],W=(L[1],(0,M.useRef)(0)),G=(0,M.useState)([]),U=i()(G,2),B=U[0],q=U[1],H=(0,M.useState)(null),K=i()(H,2),$=K[0],Q=K[1],ee=(0,M.useState)(!1),ne=i()(ee,2),te=ne[0],re=ne[1],ae=(0,M.useRef)(""),se=(0,M.useRef)(null),le=(0,M.useRef)([]),oe=(0,M.useRef)(null),ie=(0,M.useRef)(0),ce=(0,O.Z)(),ue=ce.initialize,de=ce.updateScrollerPosition,fe=(0,M.useMemo)((function(){return(0,E.kA)([{role:E.G7.System,content:k}].concat(I()(B)))}),[B,k]),pe=function(){W.current=W.current+1},he=function(){var e,n;null===(e=se.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),f(s,!1)},ge=function(e){var n;Q(R()({},null!==(n=null==e?void 0:e.usage)&&void 0!==n?n:{})),e&&Z().get(e,"choices",[].length)&&(ae.current=ae.current+Z().get(e,"choices.0.delta.content",""),q([].concat(I()(B),I()(le.current),[{role:E.G7.Assistant,content:ae.current,uid:W.current}])))},xe=function(){var e=l()(a()().mark((function e(n){var t,r,l,o,i,c,u,d,m,p,h;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.model){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,f(s,!0),pe(),null===(t=se.current)||void 0===t||null===(r=t.abort)||void 0===r||r.call(t),se.current=new AbortController,l=se.current.signal,le.current=n?[R()(R()({},n),{},{uid:W.current})]:[],q((function(e){return[].concat(I()(e),I()(le.current))})),ae.current="",o=[{role:E.G7.System,content:k}].concat(I()(B),I()(le.current)),i=(0,E.kA)(o),c=R()(R()({messages:i},P),{},{stream:!0,stream_options:{include_usage:!0}}),e.next=16,(0,T.U3)({data:c,url:N.qt,signal:l});case 16:if(null==(u=e.sent)||!u.error){e.next=20;break}return Q({error:!0,errorMessage:(null==u||null===(d=u.data)||void 0===d||null===(d=d.error)||void 0===d?void 0:d.message)||(null==u||null===(m=u.data)||void 0===m?void 0:m.message)||""}),e.abrupt("return");case 20:return pe(),p=u.reader,h=u.decoder,e.next=24,(0,T.LN)(p,h,(function(e){var n;null!=e&&e.error?Q({error:!0,errorMessage:(null==e||null===(n=e.error)||void 0===n?void 0:n.message)||(null==e?void 0:e.message)||""}):ge(e)}));case 24:e.next=28;break;case 26:e.prev=26,e.t0=e.catch(2);case 28:return e.prev=28,f(s,!1),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[2,26,28,31]])})));return function(n){return e.apply(this,arguments)}}(),ye=function(e){var n,t=e.content||null!==(n=e.imgs)&&void 0!==n&&n.length?e:void 0;xe(t)},be=(0,M.useCallback)((function(e,n){b.current?(z(R()(R()({},P),n)),d(R()({},n))):z(R()(R()({},P),e))}),[P,b.current]),je=function(){q([]),Q(null),le.current=[]},we=function(e){pe(),q((function(n){return[].concat(I()(n),[R()(R()({},e),{},{uid:W.current})])}))},ke=function(e){le.current=[];var n=Z().map(e,(function(e){return pe(),{role:e.role,content:e.content,uid:W.current}}));Q(null),q(n)},Se=((0,M.useMemo)((function(){return h.filter((function(e){return"empty"!==e.type}))}),[h]),(0,M.useMemo)((function(){var e=[{label:x.formatMessage({id:"common.button.clear"}),key:"clear",icon:(0,V.jsx)(ze.Z,{}),danger:!1,onClick:function(){q([]),S("")}},{label:x.formatMessage({id:"playground.viewcode"}),key:"viewcode",icon:(0,V.jsx)(c.Z,{type:"icon-code"}),onClick:function(){re(!0)}}];return r.length>2&&e.push({label:x.formatMessage({id:"common.button.delete"}),key:"delete",icon:(0,V.jsx)(Fe.Z,{}),danger:!0,onClick:function(){m(s)}}),e}),[r,x]));return(0,M.useEffect)((function(){z(R()(R()({},P),u))}),[u]),(0,M.useEffect)((function(){return function(){he()}}),[]),(0,M.useEffect)((function(){oe.current&&ue(oe.current)}),[oe.current,ue]),(0,M.useEffect)((function(){v[s]&&de()}),[B]),(0,M.useEffect)((function(){B.length>ie.current&&de(),ie.current=B.length}),[B.length]),(0,M.useImperativeHandle)(n,(function(){return{submit:ye,abortFetch:he,addNewMessage:we,clear:je,presetPrompt:ke,setSystemMessage:S,loading:D}})),(0,V.jsxs)("div",{className:"model-item",children:[(0,V.jsxs)("div",{className:"header",children:[(0,V.jsx)("span",{className:"title",children:(0,V.jsx)(We.default,{style:{width:"100%"},variant:"borderless",options:h,onChange:function(e){z(R()(R()({},P),{},{model:e})),je()},value:P.model,labelRender:function(e){return(0,V.jsx)(Ee.Z,{ghost:!0,tooltipProps:{placement:"right"},minWidth:60,maxWidth:180,children:e.label})},optionRender:function(e){return(0,V.jsx)(Ee.Z,{ghost:!0,tooltipProps:{placement:"right"},minWidth:60,maxWidth:180,children:e.label})}})}),(0,V.jsx)(ve,{usage:$,scaleable:!0}),(0,V.jsxs)("span",{className:"action",children:[(0,V.jsx)(Ge.Z,{menu:{items:Se},placement:"bottomRight",children:(0,V.jsx)(y.ZP,{type:"text",icon:(0,V.jsx)(Le.Z,{style:{fontSize:"14px"}}),size:"small"})}),(0,V.jsx)(Ue.Z,{placement:"bottomRight",content:(0,V.jsx)(me,{showModelSelector:!1,setParams:z,modelList:r,globalParams:u,selectedModel:P.model,onValuesChange:be}),trigger:["click"],arrow:!1,fresh:!0,title:(0,V.jsx)("div",{children:(0,V.jsx)(Y.Z,{onChange:function(e){b.current=e.target.checked,e.target.checked&&d(R()({},Z().omit(P,"model")))},children:x.formatMessage({id:"playground.compare.applytoall"})})}),children:(0,V.jsx)(y.ZP,{type:"text",icon:(0,V.jsx)(De.Z,{}),size:"small"})})]})]}),(0,V.jsx)(X,{showApplyToAll:!0,systemMessage:k,applyToAll:p,setSystemMessage:S}),(0,V.jsx)("div",{className:"content",ref:oe,children:(0,V.jsxs)("div",{children:[(0,V.jsx)(J,{messageList:B,setMessageList:q,editable:!0}),(0,V.jsx)(A.Z,{spinning:!!v[s],size:"small",style:{width:"100%"}})]})}),(0,V.jsx)(Ne,R()(R()({},E.NW.chat),{},{open:te,payload:{messages:fe},parameters:P,onCancel:function(){re(!1)},title:x.formatMessage({id:"playground.viewcode"})}))]})})),Be=M.memo(Ve),qe=function(e){var n=e.spans,t=e.modelSelections,r=e.setModelRefs;return(0,V.jsx)(Te.Z,{gutter:[16,0],style:{height:"100%"},children:t.map((function(e,a){return(0,V.jsx)(Ae.Z,{span:n.span,style:{height:n.count<4?"calc(100% - 16px)":"calc(50% - 16px)"},children:(0,V.jsx)(Be,{ref:function(n){return r(e.instanceId,n)},instanceId:e.instanceId,modelList:t,model:e.value},"".concat(e.value||"empty","-").concat(e.uid))},"".concat(e.value||"empty","-").concat(e.uid))}))})},He=M.memo(qe),Je=function(e){var n=e.modelList,t=e.loaded,r=(0,O.Z)().initialize,s=(0,M.useState)({}),o=i()(s,2),c=o[0],u=o[1],d=(0,M.useState)([]),f=i()(d,2),m=f[0],p=f[1],h=(0,M.useState)({seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024}),v=i()(h,2),g=v[0],x=v[1],y=(0,M.useState)({span:12,count:2}),b=i()(y,2),j=b[0],w=b[1],k=(0,M.useRef)({}),S=(0,M.useRef)({}),_=(0,M.useRef)(null),N=(0,M.useMemo)((function(){return Object.getOwnPropertySymbols(c).some((function(e){return c[e]}))}),[c]),C=((0,M.useMemo)((function(){return n.map((function(e){return R()(R()({},e),{},{disabled:m.some((function(n){return n.value===e.value}))})}))}),[n,m]),function(e){return k.current[e]=Z().add(k.current[e],1),k.current[e]}),P=(0,M.useCallback)((function(e,n){S.current[e]=n}),[]);return(0,M.useEffect)((function(){S.current={};var e=Z().take(n,j.count);if(e.length<j.count&&e.length>0){var t=j.count-e.length,r=Array.from({length:t},(function(e,n){return{label:"",value:"",type:"empty"}}));e=Z().concat(e,r)}var a=e.map((function(e){return R()(R()({},e),{},{uid:C(e.value||"empty"),instanceId:"empty"===e.type?Symbol("empty"):Symbol(e.value)})}));p(a)}),[n]),(0,M.useEffect)((function(){_.current&&r(_.current)}),[_.current,r]),(0,V.jsxs)("div",{className:"multiple-chat",style:{height:"calc(100vh - 72px)"},children:[(0,V.jsx)("div",{className:"chat-list",ref:_,children:n.length>0?(0,V.jsx)(Pe.Provider,{value:{spans:j,globalParams:g,loadingStatus:c,modelFullList:n,handleApplySystemChangeToAll:function(e){Object.getOwnPropertySymbols(S.current).forEach((function(n){var t=S.current[n];null==t||t.setSystemMessage(e)}))},setGlobalParams:x,setLoadingStatus:function(e,n){u((function(t){var r=R()({},t);return r[e]=n,r}))},handleDeleteModel:function(e){var n,t=m.filter((function(n){return n.instanceId!==e}));!function(e){S.current[e]=null,c[e]=!1}(e),n=j.count-1,6===j.count?w({span:8,count:n}):5===j.count?w({span:12,count:n}):4===j.count?w({span:8,count:n}):3===j.count&&w({span:12,count:n}),p(t)}},children:(0,V.jsx)(He,{spans:j,modelSelections:m,setModelRefs:P})}):t&&(0,V.jsx)(Oe,{style:{height:"100%",paddingBottom:60}})}),(0,V.jsx)("div",{children:(0,V.jsx)(z.Z,{loading:N,disabled:N||!m.length||!n.length,handleSubmit:function(e){Object.getOwnPropertySymbols(S.current).forEach((function(n){var t=S.current[n];null==t||t.submit(e)}))},addMessage:function(e){Object.getOwnPropertySymbols(S.current).forEach((function(n){var t=S.current[n];null==t||t.addNewMessage(e)}))},handleAbortFetch:function(){Object.getOwnPropertySymbols(S.current).forEach((function(e){var n=S.current[e];null==n||n.abortFetch()}))},clearAll:function(){Object.getOwnPropertySymbols(S.current).forEach((function(e){var n=S.current[e];null==n||n.clear()}))},updateLayout:function(e){w(e),function(e){var t=m;if(t.length<e.count){var r=e.count-t.length,a=Z().slice(n,t.length,t.length+r),s=Array.from({length:r-a.length},(function(e,n){return{label:"",value:"",type:"empty"}})),l=Z().concat(a,s).map((function(e){return R()(R()({},e),{},{uid:C(e.value||"empty"),instanceId:"empty"===e.type?Symbol("empty"):Symbol(e.value)})}));p(Z().concat(t,l))}else if(t.length>e.count){var o=t.slice(0,e.count);p(o)}}(e)},setModelSelections:function(e){var n=e.map((function(e){return R()(R()({},e),{},{uid:C(e.value),instanceId:Symbol(e.value)})})),t=Z().concat(m,n),r=Math.floor(24/t.length);w({span:r<8?8:r,count:j.count}),p(t)},presetPrompt:function(e){var n=e.filter((function(e){return"system"===e.role})),t=e.filter((function(e){return"user"===e.role}));Object.getOwnPropertySymbols(S.current).forEach(function(){var e=l()(a()().mark((function e(r){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(s=S.current[r])||s.presetPrompt(t),null==s||s.setSystemMessage(Z().get(n,"0.content",""));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},defaultSize:{minRows:5,maxRows:5}})})]})},Ke=(0,M.memo)(Je),Ye=(t(64232),function(){var e=(0,g.useIntl)(),n=(0,f.Z)().size,t=(0,M.useState)("chat"),r=i()(t,2),s=r[0],o=r[1],w=(0,M.useRef)(null),S=(0,M.useRef)(null),C=(0,M.useState)([]),R=i()(C,2),P=R[0],I=R[1],O=(0,M.useState)(!1),T=i()(O,2),A=T[0],E=T[1],z=[{label:e.formatMessage({id:"menu.playground.chat"}),value:"chat",icon:(0,V.jsx)(p.Z,{})},{label:e.formatMessage({id:"menu.compare"}),value:"compare",icon:(0,V.jsx)(h.Z,{})}],F=(0,M.useCallback)((function(){var e,n;if("reranker"===s)null===(e=S.current)||void 0===e||null===(n=e.viewCode)||void 0===n||n.call(e);else if("chat"===s){var t,r;null===(t=w.current)||void 0===t||null===(r=t.viewCode)||void 0===r||r.call(t)}}),[w,S,s]),L=(0,M.useCallback)((function(){var e,n,t,r;"reranker"!==s?null===(e=w.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e):null===(t=S.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t)}),[w,S,s]),D=[{key:"chat",label:"Chat",children:(0,V.jsx)(Re,{ref:w,modelList:P})},{key:"compare",label:"Compare",children:(0,V.jsx)(Ke,{modelList:P,loaded:A})}];(0,M.useEffect)((function(){var e,t,r;n.width<u.Z.lg&&(null!==(e=w.current)&&void 0!==e&&e.collapse||null===(t=w.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t))}),[n.width]),(0,M.useEffect)((function(){var e=function(){var e=l()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={categories:m.Us.llm,with_meta:!0},e.next=4,(0,N.nb)(n);case 4:return t=e.sent,r=Z().map(t.data||[],(function(e){return{value:e.id,label:e.id,meta:e.meta}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var n=l()(a()().mark((function n(){var t;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e();case 3:t=n.sent,I(t),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),E(!0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();n()}),[]);return(0,_.y1)(d.ZP.RIGHT.join(","),(function(){var e,n;null===(e=w.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),{preventDefault:!0}),(0,V.jsx)(v._z,{ghost:!0,header:{title:(0,V.jsxs)("div",{className:"flex items-center",children:[(0,V.jsx)("span",{className:"font-600",children:e.formatMessage({id:"menu.playground.chat"})}),(0,V.jsx)(b.Z,{options:z,size:"middle",className:"m-l-40",onChange:function(e){return o(e)}})]}),breadcrumb:{}},extra:"compare"!==s&&(0,V.jsxs)(x.Z,{children:[(0,V.jsx)(y.ZP,{size:"middle",onClick:F,icon:(0,V.jsx)(c.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,V.jsx)(y.ZP,{size:"middle",onClick:L,icon:(0,V.jsx)(c.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:k()("playground-container",{compare:"compare"===s,chat:"compare"!==s}),children:(0,V.jsx)("div",{className:"play-ground",children:(0,V.jsx)("div",{className:"chat",children:(0,V.jsx)(j.Z,{items:D,activeKey:s})})})})})},69510:function(e,n,t){t.d(n,{HH:function(){return N},LN:function(){return C},U3:function(){return M},YT:function(){return P}});var r=t(335),a=t.n(r),s=t(15558),l=t.n(s),o=t(25298),i=t.n(o),c=t(17069),u=t.n(c),d=t(82092),f=t.n(d),m=t(31759),p=t.n(m),h=t(26068),v=t.n(h),g=t(90228),x=t.n(g),y=t(87999),b=t.n(y),j=t(32699),w=t(28694),k=/data:\s*({.*?})(?=\n|$)/g,S=function(e){var n,t=[];if(!e)return t;for(;null!==(n=k.exec(e));)try{var r=JSON.parse(n[1]);t.push(r)}catch(e){continue}return t},Z=function(){var e=b()(x()().mark((function e(n){var t;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.json();case 3:return t=e.sent,e.abrupt("return",{error:!0,data:t});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{error:!0,message:n.statusText});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),M=function(){var e=b()(x()().mark((function e(n){var t,r,a,s,l,o;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.method||"POST",a=n.url,n.params&&(a="".concat(a,"?").concat(w.Z.stringify(n.params))),e.next=5,fetch(a,{method:r,body:"POST"===r?JSON.stringify(n.data):null,signal:n.signal,headers:v()({"Content-Type":"application/json"},n.headers)});case 5:if((s=e.sent).ok){e.next=11;break}return e.next=9,Z(s);case 9:return e.t0=e.sent,e.abrupt("return",{error:!0,data:e.t0});case 11:return l=null==s||null===(t=s.body)||void 0===t?void 0:t.getReader(),o=new TextDecoder("utf-8",{fatal:!0}),e.abrupt("return",{reader:l,decoder:o});case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=function(e){var n=new FormData,t=function(e,t){t instanceof File?n.append(e,t):"object"===p()(t)&&null!==t?n.append(e,JSON.stringify(t)):null!=t&&n.append(e,t)};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r]);return n},N=function(){var e=b()(x()().mark((function e(n){var t,r,a,s,l;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.url,e.next=3,fetch(r,{method:"POST",body:_(n.data),signal:n.signal});case 3:if((a=e.sent).ok){e.next=9;break}return e.next=7,Z(a);case 7:return e.t0=e.sent,e.abrupt("return",{error:!0,data:e.t0});case 9:return s=null==a||null===(t=a.body)||void 0===t?void 0:t.getReader(),l=new TextDecoder("utf-8",{fatal:!0}),e.abrupt("return",{reader:s,decoder:l});case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),C=function(){var e=b()(x()().mark((function e(n,t,r){var a,s,o,c,d,m,p,h,v,g,y=arguments;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=y.length>3&&void 0!==y[3]?y[3]:200,s=new(function(){function e(){i()(this,e),f()(this,"buffer",[])}return u()(e,[{key:"add",value:function(e){this.buffer.push(e)}},{key:"flush",value:function(){if(this.buffer.length>0){var e=l()(this.buffer);this.buffer=[],e.forEach((function(e){return r(e)}))}}},{key:"getBuffer",value:function(){return this.buffer}}]),e}()),o=(0,j.throttle)((function(){s.flush()}),a),c=!0;case 5:if(!c){e.next=18;break}return e.next=8,n.read();case 8:if(d=e.sent,m=d.done,p=d.value,!m){e.next=15;break}return c=!1,s.flush(),e.abrupt("break",18);case 15:try{(h=t.decode(p,{stream:!0})).startsWith("error:")?(v=h.slice(7).trim(),g=JSON.parse(v),s.add({error:g})):S(h).forEach((function(e){s.add(e)})),o()}catch(e){s.add({error:e})}e.next=5;break;case 18:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),R=function(){var e=b()(x()().mark((function e(n,t){var r,s,l,o,i,c,u,d,f;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:r=n.split("\n"),s=a()(r);try{for(s.s();!(l=s.n()).done;)if(o=l.value,(i=o.trim()).startsWith("data: ")){c=i.slice(6).trim();try{"[DONE]"!==c&&(u=JSON.parse(c),t(u))}catch(e){}}else if(i.startsWith("error:")){d=i.slice(7).trim();try{f=JSON.parse(d),t({error:f})}catch(e){}}}catch(e){s.e(e)}finally{s.f()}case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),P=function(){var e=b()(x()().mark((function e(n,t,r){var s,l,o,c,d,m,p,h,v,g,y,w,k,S=arguments;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=S.length>3&&void 0!==S[3]?S[3]:200,l="",o=function(){function e(n){i()(this,e),f()(this,"buffer",[]),f()(this,"failed",!1),f()(this,"isFlushing",!1),f()(this,"callback",void 0),this.callback=n}var n;return u()(e,[{key:"add",value:function(e){this.buffer.push(e)}},{key:"flush",value:(n=b()(x()().mark((function e(){var n;return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.buffer.length&&!this.isFlushing){e.next=2;break}return e.abrupt("return");case 2:this.failed=!1,this.isFlushing=!0;case 4:if(!(this.buffer.length>0)){e.next=18;break}n=this.buffer.shift(),e.prev=6,R(n,this.callback),e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(6),this.failed=!0,this.buffer.unshift(n),e.abrupt("break",18);case 16:e.next=4;break;case 18:this.isFlushing=!1;case 19:case"end":return e.stop()}}),e,this,[[6,10]])}))),function(){return n.apply(this,arguments)})},{key:"getBuffer",value:function(){return this.buffer}}]),e}(),c=new o(r),d=(0,j.throttle)(b()(x()().mark((function e(){return x()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.flush();case 1:case"end":return e.stop()}}),e)}))),s),!0;case 6:return e.next=9,null==n||null===(m=n.read)||void 0===m?void 0:m.call(n);case 9:if(p=e.sent,h=p.done,v=p.value,!h){e.next=17;break}return!1,l&&c.add(l),c.flush(),e.abrupt("break",20);case 17:try{l+=t.decode(v,{stream:!0}),g=l.split("\n"),l=g.pop()||"",y=a()(g);try{for(y.s();!(w=y.n()).done;)k=w.value,c.add(k)}catch(e){y.e(e)}finally{y.f()}d()}catch(e){}e.next=6;break;case 20:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}()}}]);