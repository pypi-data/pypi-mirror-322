import{n as S}from"./index.browser-OxPLOBIU.js";import{x as h,az as T,r as c,o as N,I as o,ag as I,b as P,w as $,y as u,D as C,n as r,A as i,G as a,S as l,J as m,B as s,z as g,K as V,aS as j}from"./index-B55Az6uZ.js";import{E as z}from"./EditConfig-l0E5Mqzr.js";import{b as D,V as w,a as y}from"./VCardText-6y4Yo2hg.js";import{e as U}from"./VMenu-BJOay2FN.js";import{V as L}from"./VList-BbG08zRJ.js";import{a as O,V as G}from"./VCard-Ba6kturx.js";import{v as H,C as J}from"./VListItem-CTt5-rrr.js";import"./VExpansionPanels-B7Tl_w95.js";import"./VCheckboxBtn-gndQvl0N.js";import"./VAlert-DmQ6rEG3.js";import"./VSwitch-DNBVwREp.js";import"./VTextField-DVCLCsz9.js";import"./VVirtualScroll-Ds3B_Lds.js";import"./VChip-USL2zd6t.js";import"./VSlider-fbZzMnSw.js";import"./VForm-xNYk87zc.js";import"./VSpacer-Bt_rBx5Q.js";/* empty css              */import"./VDialog-B4Ltljs_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K={key:0,style:{"margin-left":"-5px","margin-right":"-5px"}},R={id:"auth",href:"",target:"_blank"},pe=h({__name:"AddProvider",props:{domain:{}},setup(A){const B=T(),p=c([]),b=S(11),d=c(!1),f=c(!1),v=A;N(()=>{const t=o.subscribe(I.AUTH_SESSION,e=>{if(e.object_id!==b)return;const n=e.data;f.value=!0,window.setTimeout(()=>{const k=document.getElementById("auth");k.setAttribute("href",n),k.click()},100)});P(t)}),$(()=>v.domain,async t=>{t&&(p.value=await o.getProviderConfigEntries(v.domain,void 0,void 0,{session_id:b}))},{immediate:!0});const E=async function(t){d.value=!0,o.saveProviderConfig(v.domain,t).then(()=>{B.push({name:"providersettings"})}).catch(e=>{alert(e)}).finally(()=>{d.value=!1,f.value=!1})},M=async function(t,e){d.value=!0;for(const n of p.value)n.value!==void 0&&e[n.key]==null&&(e[n.key]=n.value);e.session_id=b,o.getProviderConfigEntries(v.domain,void 0,t,e).then(n=>{p.value=n}).catch(n=>{alert(n)}).finally(()=>{d.value=!1,f.value=!1})};return(t,e)=>(u(),C("section",null,[r(D,null,{default:i(()=>[a(o).providerManifests[t.domain]?(u(),C("div",K,[r(w,null,{default:i(()=>[l(m(t.$t("settings.setup_provider",[a(o).providerManifests[t.domain].name])),1)]),_:1}),r(y,null,{default:i(()=>[l(m(a(o).providerManifests[t.domain].description),1)]),_:1}),e[3]||(e[3]=s("br",null,null,-1)),a(o).providerManifests[t.domain].codeowners.length?(u(),g(y,{key:0},{default:i(()=>[s("b",null,m(t.$t("settings.codeowners"))+": ",1),l(m(a(o).providerManifests[t.domain].codeowners.join(" / ")),1)]),_:1})):V("",!0),a(o).providerManifests[t.domain].documentation?(u(),g(y,{key:1},{default:i(()=>[s("b",null,m(t.$t("settings.need_help_setup_provider")),1),e[2]||(e[2]=l("Â  ")),s("a",{onClick:e[0]||(e[0]=n=>a(j)(a(o).providerManifests[t.domain].documentation))},m(t.$t("settings.check_docs")),1)]),_:1})):V("",!0)])):V("",!0),e[4]||(e[4]=s("br",null,null,-1)),r(L),e[5]||(e[5]=s("br",null,null,-1)),e[6]||(e[6]=s("br",null,null,-1)),r(z,{"config-entries":p.value,disabled:!1,onSubmit:E,onAction:M},null,8,["config-entries"])]),_:1}),r(U,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=n=>d.value=n),scrim:"true",persistent:"",style:{display:"flex","align-items":"center","justify-content":"center"}},{default:i(()=>[f.value?(u(),g(G,{key:0,style:{"background-color":"white"}},{default:i(()=>[r(w,null,{default:i(()=>e[7]||(e[7]=[l("Authenticating...")])),_:1}),r(y,null,{default:i(()=>e[8]||(e[8]=[l("A new tab/popup should be opened where you can authenticate")])),_:1}),r(O,null,{default:i(()=>[s("a",R,[r(H,null,{default:i(()=>e[9]||(e[9]=[l("Click here if the popup did not open")])),_:1})])]),_:1})]),_:1})):(u(),g(J,{key:1,indeterminate:"",size:"64",color:"primary"}))]),_:1},8,["modelValue"])]))}});export{pe as default};
