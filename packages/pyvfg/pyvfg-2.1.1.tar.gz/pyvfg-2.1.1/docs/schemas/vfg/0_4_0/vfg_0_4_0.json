{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "definitions": {
        "tensor": {
            "oneOf": [
                {
                    "type": "number"
                },
                {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/tensor"
                    }
                }
            ]
        },
        "variable": {
            "type": "object",
            "properties": {
                "elements": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "cardinality": {
                    "type": "integer",
                    "minimum": 1
                },
                "role": {
                    "enum": [
                        "control_state",
                        "latent"
                    ]
                }
            },
            "oneOf": [
                {
                    "required": [
                        "elements"
                    ]
                },
                {
                    "required": [
                        "cardinality"
                    ]
                }
            ]
        },
        "factor": {
            "type": "object",
            "properties": {
                "variables": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "distribution": {
                    "enum": [
                        "categorical",
                        "categorical_conditional"
                    ]
                },
                "values": {
                    "$ref": "#/definitions/tensor"
                },
                "role": {
                    "type": "string",
                    "enum": [
                        "transition",
                        "preference",
                        "likelihood",
                        "initial_state_prior"
                    ]
                }
            },
            "required": [
                "variables",
                "distribution",
                "values"
            ]
        }
    },
    "properties": {
        "version": {
            "type": "string",
            "const": "0.4.0"
        },
        "factors": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/factor"
            }
        },
        "variables": {
            "type": "object",
            "additionalProperties": {
                "$ref": "#/definitions/variable"
            }
        },
        "visualization_metadata": {},
        "metadata": {
            "type": "object",
            "properties": {
                "model_version": {
                    "type": "string"
                },
                "model_type": {
                    "type": "string",
                    "enum": [
                        "bayesian_network",
                        "markov_random_field",
                        "pomdp",
                        "factor_graph"
                    ]
                },
                "description": {
                    "type": "string"
                }
            }
        }
    },
    "required": [
        "version",
        "factors",
        "variables"
    ]
}